{
  "session_id": "aebcfe18-69c7-4e56-9cef-326be6b6dc8c",
  "prompts": [
    "# IDENTITY and PURPOSE\n\nYou are a super powerful AI cybersecurity expert system specialized in finding and extracting proof of concept URLs and other vulnerability validation methods from submitted security/bug bounty reports.\n\nYou always output the URL that can be used to validate the vulnerability, preceded by the command that can run it: e.g., \"curl https://yahoo.com/vulnerable-app/backup.zip\".\n\n# Steps\n\n- Take the submitted security/bug bounty report and extract the proof of concept URL from it. You return the URL itself that can be run directly to verify if the vulnerability exists or not, plus the command to run it.\n\nExample: curl \"https://yahoo.com/vulnerable-example/backup.zip\"\nExample: curl -X \"Authorization: 12990\" \"https://yahoo.com/vulnerable-example/backup.zip\"\nExample: python poc.py\n\n# INPUT:\n\nINPUT:\n\n\n# INPUT\n\n# Cell 1 (markdown)\n# Claude Skills for Financial Applications\n\nBuild real-world financial dashboards, portfolio analytics, and automated reporting workflows using Claude's Excel, PowerPoint, and PDF skills.\n\n> **\ud83d\udca1 Real-world Impact:** These are the same Skills that power **[Claude Creates Files](https://www.anthropic.com/news/create-files)**, enabling Claude to create professional financial documents directly in the interface.\n\n**What you'll learn:**\n- Create comprehensive financial models in Excel with formulas and charts\n- Generate executive presentations from financial data\n- Build portfolio analysis tools with risk metrics\n- Automate multi-format reporting pipelines\n\n---\n\n# Cell 2 (markdown)\n## Table of Contents\n\n1. [Setup & Data Loading](#setup)\n2. [Use Case 1: Financial Dashboard Creation](#financial-dashboard)\n   - [Excel Financial Model](#excel-model)\n   - [Executive PowerPoint](#executive-ppt)\n   - [PDF Financial Report](#pdf-report)\n3. [Use Case 2: Portfolio Analysis Workflow](#portfolio-analysis)\n   - [Portfolio Analytics Excel](#portfolio-excel)\n   - [Investment Committee Deck](#investment-deck)\n4. [Use Case 3: Automated Reporting Pipeline](#reporting-pipeline)\n\n---\n\n# Cell 3 (markdown)\n## Prerequisites\n\nThis notebook assumes you've completed **Notebook 1: Introduction to Skills**.\n\nIf you haven't:\n1. Complete the setup in Notebook 1 first\n2. Verify your environment with the test cells\n3. Ensure you can create and download files\n\n**Required:**\n- Anthropic API key configured\n- SDK version 0.69.0 installed from whl\n- Virtual environment activated\n\n---\n\n# Cell 4 (markdown)\n## 1. Setup & Data Loading {#setup}\n\nLet's start by importing our dependencies and loading the financial data we'll work with throughout this notebook.\n\n---\n\n# Cell 5 (code)\n```python\n# Standard imports\nimport json\nimport os\nimport sys\nfrom pathlib import Path\n\nimport pandas as pd\n\n# Add parent directory for imports\nsys.path.insert(0, str(Path.cwd().parent))\n\n# Anthropic SDK\nfrom anthropic import Anthropic\nfrom dotenv import load_dotenv\n\n# Our utilities\nfrom file_utils import (\n    download_all_files,\n    print_download_summary,\n)\n\n# Load environment\nload_dotenv(Path.cwd().parent / \".env\")\n\n# Configuration\nAPI_KEY = os.getenv(\"ANTHROPIC_API_KEY\")\nMODEL = \"claude-sonnet-4-5\"\n\nif not API_KEY:\n    raise ValueError(\"ANTHROPIC_API_KEY not found. Please configure your .env file.\")\n\n# Initialize client\nclient = Anthropic(api_key=API_KEY)\n\n# Setup directories\nOUTPUT_DIR = Path.cwd().parent / \"outputs\" / \"financial\"\nOUTPUT_DIR.mkdir(parents=True, exist_ok=True)\n\nDATA_DIR = Path.cwd().parent / \"sample_data\"\n\nprint(\"\u2713 Environment configured\")\nprint(f\"\u2713 Output directory: {OUTPUT_DIR}\")\nprint(f\"\u2713 Data directory: {DATA_DIR}\")\n```\n\n---\n\n# Cell 6 (markdown)\n### Load Financial Data\n\nWe have four datasets representing different aspects of a company's financial position:\n\n---\n\n# Cell 7 (code)\n```python\n# Load financial statements\nfinancial_statements = pd.read_csv(DATA_DIR / \"financial_statements.csv\")\nprint(\"\ud83d\udcca Financial Statements Overview:\")\nprint(f\"   Shape: {financial_statements.shape}\")\nprint(f\"   Categories: {len(financial_statements['Category'].unique())} financial metrics\")\nprint(f\"   Quarters: {list(financial_statements.columns[1:5])}\")\nprint()\n\n# Show sample data\nprint(\"Sample data (first 5 rows):\")\nfinancial_statements.head()\n```\n\n---\n\n# Cell 8 (code)\n```python\n# Load portfolio holdings\nwith open(DATA_DIR / \"portfolio_holdings.json\") as f:\n    portfolio_data = json.load(f)\n\nprint(\"\ud83d\udcbc Portfolio Overview:\")\nprint(f\"   Portfolio: {portfolio_data['portfolio_name']}\")\nprint(f\"   Total Value: ${portfolio_data['total_value']:,.2f}\")\nprint(f\"   Holdings: {len(portfolio_data['holdings'])} stocks\")\nprint(f\"   Cash Position: ${portfolio_data['cash_position']['amount']:,.2f}\")\nprint(f\"   Total Return: {portfolio_data['performance_metrics']['total_return_percent']:.1f}%\")\nprint()\n\n# Convert holdings to DataFrame for easier manipulation\nportfolio_df = pd.DataFrame(portfolio_data[\"holdings\"])\nprint(\"Top 5 holdings by value:\")\nportfolio_df.nlargest(5, \"market_value\")[[\"ticker\", \"name\", \"market_value\", \"unrealized_gain\"]]\n```\n\n---\n\n# Cell 9 (code)\n```python\n# Load quarterly metrics\nwith open(DATA_DIR / \"quarterly_metrics.json\") as f:\n    quarterly_metrics = json.load(f)\n\nprint(\"\ud83d\udcc8 Quarterly Metrics Overview:\")\nprint(f\"   Quarters available: {len(quarterly_metrics['quarters'])}\")\nprint(f\"   Metrics per quarter: {len(quarterly_metrics['quarters'][0])} KPIs\")\nprint()\n\n# Show latest quarter metrics\nlatest_quarter = quarterly_metrics[\"quarters\"][-1]\nprint(f\"Latest Quarter ({latest_quarter['quarter']}):\")\nfor key, value in latest_quarter.items():\n    if key != \"quarter\" and isinstance(value, int | float):\n        if \"revenue\" in key.lower() or \"cost\" in key.lower():\n            print(f\"   {key.replace('_', ' ').title()}: ${value:,.0f}\")\n        elif \"percent\" in key.lower() or \"margin\" in key.lower() or \"rate\" in key.lower():\n            print(f\"   {key.replace('_', ' ').title()}: {value:.1f}%\")\n        else:\n            print(f\"   {key.replace('_', ' ').title()}: {value:,.0f}\")\n```\n\n---\n\n# Cell 10 (markdown)\n### Helper Functions\n\nLet's define some helper functions for this notebook:\n\n---\n\n# Cell 11 (code)\n```python\ndef create_skills_message(client, prompt, skills, prefix=\"\", show_token_usage=True):\n    \"\"\"\n    Helper function to create messages with Skills.\n\n    Args:\n        client: Anthropic client\n        prompt: User prompt\n        skills: List of skill dicts [{\"type\": \"anthropic\", \"skill_id\": \"xlsx\", \"version\": \"latest\"}]\n        prefix: Prefix for downloaded files\n        show_token_usage: Whether to print token usage\n\n    Returns:\n        Tuple of (response, download_results)\n    \"\"\"\n    response = client.beta.messages.create(\n        model=MODEL,\n        max_tokens=4096,\n        container={\"skills\": skills},\n        tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n        messages=[{\"role\": \"user\", \"content\": prompt}],\n        betas=[\n            \"code-execution-2025-08-25\",\n            \"files-api-2025-04-14\",\n            \"skills-2025-10-02\",\n        ],\n    )\n\n    if show_token_usage:\n        print(\n            f\"\\n\ud83d\udcca Token Usage: {response.usage.input_tokens} in, {response.usage.output_tokens} out\"\n        )\n\n    # Download files\n    results = download_all_files(client, response, output_dir=str(OUTPUT_DIR), prefix=prefix)\n\n    return response, results\n\n\ndef format_financial_value(value, is_currency=True, decimals=0):\n    \"\"\"Format financial values for display.\"\"\"\n    if is_currency:\n        return f\"${value:,.{decimals}f}\"\n    else:\n        return f\"{value:,.{decimals}f}\"\n\n\nprint(\"\u2713 Helper functions defined\")\n```\n\n---\n\n# Cell 12 (markdown)\n## 2. Use Case 1: Financial Dashboard Creation {#financial-dashboard}\n\nNow that we have our data loaded and helper functions defined, let's dive into our first practical use case: creating comprehensive financial dashboards. We'll start by generating multi-sheet Excel workbooks that automatically include formulas, formatting, and charts.\n\n### 2.1 Excel Financial Model {#excel-model}\n\nWe'll create a financial dashboard that includes:\n- Profit & Loss statements with year-over-year comparisons\n- Balance sheet analysis\n- Cash flow tracking\n- KPI dashboards with visualizations\n\nThis demonstrates how Claude's Skills can handle complex Excel generation tasks that would typically require hours of manual work.\n\n---\n\n# Cell 13 (code)\n```python\n# Create Financial Dashboard Excel\nprint(\"Creating financial dashboard Excel file...\")\nprint(\"This creates a 2-sheet dashboard optimized for the Skills API.\")\nprint(\"\\n\u23f1\ufe0f Generation time: 1-2 minutes\\n\")\n\n# Prepare the financial data\nfs_data = financial_statements.to_dict(\"records\")\nquarters_2024 = [\"Q1_2024\", \"Q2_2024\", \"Q3_2024\", \"Q4_2024\"]\n\n# Extract key financial metrics\nrevenue_by_quarter = {\n    \"Q1 2024\": financial_statements[financial_statements[\"Category\"] == \"Revenue\"][\n        \"Q1_2024\"\n    ].values[0],\n    \"Q2 2024\": financial_statements[financial_statements[\"Category\"] == \"Revenue\"][\n        \"Q2_2024\"\n    ].values[0],\n    \"Q3 2024\": financial_statements[financial_statements[\"Category\"] == \"Revenue\"][\n        \"Q3_2024\"\n    ].values[0],\n    \"Q4 2024\": financial_statements[financial_statements[\"Category\"] == \"Revenue\"][\n        \"Q4_2024\"\n    ].values[0],\n}\n\nfinancial_dashboard_prompt = f\"\"\"\nCreate a financial dashboard Excel workbook with 2 sheets:\n\nSheet 1 - \"P&L Summary\":\nCreate a Profit & Loss summary table for 2024 quarters with these rows:\n- Revenue: {\", \".join([f\"Q{i + 1}: ${v / 1000000:.1f}M\" for i, v in enumerate(revenue_by_quarter.values())])}\n- Gross Profit: Use values from the data\n- Operating Income: Use values from the data\n- Net Income: Use values from the data\n- Add a Total column with SUM formulas\n- Add a row showing profit margins (Net Income / Revenue)\n- Apply currency formatting and bold headers\n- Add a simple bar chart showing quarterly revenue\n\nSheet 2 - \"Key Metrics\":\nCreate a metrics dashboard with:\n- Total Revenue 2024: SUM of all quarters\n- Average Quarterly Revenue: AVERAGE formula\n- Q4 vs Q1 Growth: Percentage increase\n- Best Quarter: MAX formula to identify\n- Operating Margin Q4: Calculate from data\n- Year-over-year growth vs 2023\n\nApply professional formatting with borders, bold headers, and currency formats.\n\"\"\"\n\n# Create the Excel financial dashboard\nexcel_response, excel_results = create_skills_message(\n    client,\n    financial_dashboard_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"xlsx\", \"version\": \"latest\"}],\n    prefix=\"financial_dashboard_\",\n)\n\nprint(\"\\n\" + \"=\" * 60)\nprint_download_summary(excel_results)\n\nif len(excel_results) > 0 and excel_results[0][\"success\"]:\n    print(\"\\n\u2705 Financial dashboard Excel created successfully!\")\n```\n\n---\n\n# Cell 14 (markdown)\n### \ud83d\udca1 Best Practices for Excel Generation\n\nBased on our testing, here are the optimal approaches for creating Excel files with Skills:\n\n**Recommended Approach:**\n- **2-3 sheets per workbook** works reliably and generates quickly\n- **Focus each sheet** on a specific purpose (e.g., P&L, metrics, charts)\n- **Add complexity incrementally** - start simple, then enhance\n\n**For Complex Dashboards:**\n1. **Create multiple focused files** instead of one complex file\n   - Example: `financial_pnl.xlsx`, `balance_sheet.xlsx`, `kpi_dashboard.xlsx`\n2. **Use the pipeline pattern** to create and enhance files sequentially\n3. **Combine files programmatically** using pandas or openpyxl if needed\n\n**Performance Tips:**\n- Simple 2-sheet dashboards: ~1-2 minutes\n- PowerPoint and PDF generation: Very reliable for complex content\n- Token usage: Structured data (JSON/CSV) is more efficient than prose\n\n---\n\n# Cell 15 (markdown)\n### 2.2 Executive PowerPoint {#executive-ppt}\n\nWith our financial data now organized in Excel, let's create an executive presentation that summarizes the key insights. This demonstrates how Skills can generate professional PowerPoint presentations with charts, formatted text, and multiple slides - perfect for board meetings or investor updates.\n\nThe presentation will include:\n- Q4 2024 performance highlights\n- Financial metrics with year-over-year comparisons\n- Profitability trends with visualizations\n- Key takeaways and outlook\n\n---\n\n# Cell 16 (code)\n```python\nprint(\"Creating executive presentation from financial metrics...\")\nprint(\"\\n\u23f1\ufe0f Generation time: 1-2 minutes\\n\")\n\n# Calculate some key metrics for the presentation\nq4_2024_revenue = 14500000\nq4_2023_revenue = 12300000\nyoy_growth = (q4_2024_revenue - q4_2023_revenue) / q4_2023_revenue * 100\n\nq4_2024_net_income = 1878750\nq4_2023_net_income = 1209000\nnet_income_growth = (q4_2024_net_income - q4_2023_net_income) / q4_2023_net_income * 100\n\nexecutive_ppt_prompt = f\"\"\"\nCreate a 4-slide executive presentation for Q4 2024 financial results:\n\nSlide 1 - Title:\n- Title: \"Q4 2024 Financial Results\"\n- Subtitle: \"Executive Summary - Acme Corporation\"\n- Date: January 2025\n\nSlide 2 - Financial Highlights:\n- Title: \"Q4 2024 Performance Highlights\"\n- Create a two-column layout:\n  Left side - Key Metrics:\n  \u2022 Revenue: $14.5M (+{yoy_growth:.1f}% YoY)\n  \u2022 Net Income: $1.88M (+{net_income_growth:.1f}% YoY)\n  \u2022 Operating Margin: 17.9% (up 2.9pp)\n  \u2022 Operating Cash Flow: $2.85M\n\n  Right side - Column chart showing quarterly revenue:\n  Q1 2024: $12.5M\n  Q2 2024: $13.2M\n  Q3 2024: $13.8M\n  Q4 2024: $14.5M\n\nSlide 3 - Profitability Trends:\n- Title: \"Margin Expansion & Profitability\"\n- Add a line chart showing net margin % by quarter:\n  Q1 2024: 11.4%\n  Q2 2024: 11.8%\n  Q3 2024: 12.4%\n  Q4 2024: 13.0%\n- Add bullet points below:\n  \u2022 Consistent margin expansion throughout 2024\n  \u2022 Operating leverage driving profitability\n  \u2022 Cost optimization initiatives delivering results\n\nSlide 4 - Key Takeaways:\n- Title: \"Key Takeaways & Outlook\"\n- Bullet points:\n  \u2713 Record Q4 revenue of $14.5M\n  \u2713 17.9% YoY revenue growth\n  \u2713 55% increase in net income YoY\n  \u2713 Strong cash generation: $2.85M operating cash flow\n  \u2713 Well-positioned for continued growth in 2025\n\nUse professional corporate design:\n- Dark blue (#003366) for headers\n- Clean, modern layout\n- Data-driven visualizations\n\"\"\"\n\n# Create the executive presentation\nppt_response, ppt_results = create_skills_message(\n    client,\n    executive_ppt_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"pptx\", \"version\": \"latest\"}],\n    prefix=\"executive_summary_\",\n)\n\nprint(\"\\n\" + \"=\" * 60)\nprint_download_summary(ppt_results)\n\nif len(ppt_results) > 0 and ppt_results[0][\"success\"]:\n    print(\"\\n\u2705 Executive presentation created successfully!\")\n```\n\n---\n\n# Cell 17 (markdown)\n## 3. Use Case 2: Portfolio Analysis Workflow {#portfolio-analysis}\n\nNow let's shift our focus from company financials to investment portfolio analysis. In this section, we'll demonstrate how to create comprehensive portfolio analytics and investment committee presentations using the portfolio data we loaded earlier.\n\nThis workflow showcases:\n- Detailed portfolio performance analysis in Excel\n- Risk metrics and sector allocation visualization\n- Professional investment committee presentations\n- Data-driven rebalancing recommendations\n\nWe'll start by creating an Excel workbook with portfolio analytics, then generate an investment committee presentation that summarizes our findings.\n\n---\n\n# Cell 18 (markdown)\n### First, let's create a comprehensive portfolio analysis Excel workbook\n\nBefore we create the investment committee presentation, we need to analyze our portfolio data in detail. This Excel workbook will serve as the foundation for our investment recommendations.\n\n---\n\n# Cell 19 (code)\n```python\nprint(\"Creating portfolio analysis Excel workbook...\")\nprint(\"This creates a focused 2-sheet portfolio analysis optimized for the Skills API.\")\nprint(\"\\n\u23f1\ufe0f Generation time: 1-2 minutes\\n\")\n\n# Prepare portfolio data for the prompt\ntop_holdings = portfolio_df.nlargest(5, \"market_value\")\nsector_allocation = portfolio_data[\"sector_allocation\"]\n\nportfolio_excel_prompt = f\"\"\"\nCreate a portfolio analysis Excel workbook with 2 sheets:\n\nSheet 1 - \"Portfolio Overview\":\nCreate a comprehensive holdings and performance table:\n\nSection 1 - Holdings (top of sheet):\n{portfolio_df[[\"ticker\", \"name\", \"shares\", \"current_price\", \"market_value\", \"unrealized_gain\", \"allocation_percent\"]].head(10).to_string()}\n\nSection 2 - Portfolio Summary:\n- Total portfolio value: ${portfolio_data[\"total_value\"]:,.2f}\n- Total unrealized gain: ${portfolio_df[\"unrealized_gain\"].sum():,.2f}\n- Total Return: {portfolio_data[\"performance_metrics\"][\"total_return_percent\"]:.1f}%\n- YTD Return: {portfolio_data[\"performance_metrics\"][\"year_to_date_return\"]:.1f}%\n- Sharpe Ratio: {portfolio_data[\"performance_metrics\"][\"sharpe_ratio\"]:.2f}\n- Portfolio Beta: {portfolio_data[\"performance_metrics\"][\"beta\"]:.2f}\n\nApply conditional formatting: green for gains, red for losses.\nAdd a bar chart showing top 5 holdings by value.\n\nSheet 2 - \"Sector Analysis & Risk\":\nCreate sector allocation and risk metrics:\n\nSection 1 - Sector Allocation:\n{json.dumps(sector_allocation, indent=2)}\nInclude a pie chart of sector allocation.\n\nSection 2 - Key Risk Metrics:\n- Portfolio Beta: {portfolio_data[\"performance_metrics\"][\"beta\"]:.2f}\n- Standard Deviation: {portfolio_data[\"performance_metrics\"][\"standard_deviation\"]:.1f}%\n- Value at Risk (95%): $62,500\n- Maximum Drawdown: -12.3%\n- Sharpe Ratio: {portfolio_data[\"performance_metrics\"][\"sharpe_ratio\"]:.2f}\n\nSection 3 - Rebalancing Recommendations:\n- Reduce Technology from 20% to 18%\n- Increase Healthcare from 8.7% to 10%\n- Maintain current diversification\n\nApply professional formatting with clear sections and headers.\n\"\"\"\n\n# Create portfolio analysis Excel\nportfolio_response, portfolio_results = create_skills_message(\n    client,\n    portfolio_excel_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"xlsx\", \"version\": \"latest\"}],\n    prefix=\"portfolio_analysis_\",\n)\n\nprint(\"\\n\" + \"=\" * 60)\nprint_download_summary(portfolio_results)\n\nif len(portfolio_results) > 0 and portfolio_results[0][\"success\"]:\n    print(\"\\n\u2705 Portfolio analysis Excel created successfully!\")\n```\n\n---\n\n# Cell 20 (markdown)\n### 3.2 Investment Committee Presentation {#investment-deck}\n\nWith our detailed portfolio analysis complete, let's now create a professional presentation for the investment committee. This presentation will distill the key insights from our Excel analysis into a concise, visual format suitable for decision-makers.\n\nThe presentation will cover:\n- Portfolio performance summary with key metrics\n- Asset allocation and diversification analysis\n- Risk metrics and risk-adjusted returns\n- Strategic recommendations for rebalancing\n\n---\n\n# Cell 21 (code)\n```python\nprint(\"Creating investment committee presentation...\")\nprint(\"\\n\u23f1\ufe0f Generation time: 1-2 minutes\\n\")\n\ninvestment_deck_prompt = f\"\"\"\nCreate a 5-slide investment committee presentation:\n\nSlide 1 - Title:\n- Title: \"Portfolio Review - Q4 2024\"\n- Subtitle: \"{portfolio_data[\"portfolio_name\"]}\"\n- Date: January 2025\n- Portfolio Value: ${portfolio_data[\"total_value\"]:,.0f}\n\nSlide 2 - Portfolio Overview:\n- Title: \"Portfolio Performance Summary\"\n- Two-column layout:\n\n  Left - Key Metrics:\n  \u2022 Total Value: ${portfolio_data[\"total_value\"]:,.0f}\n  \u2022 YTD Return: +{portfolio_data[\"performance_metrics\"][\"year_to_date_return\"]:.1f}%\n  \u2022 Total Return: ${portfolio_data[\"performance_metrics\"][\"total_return\"]:,.0f}\n  \u2022 Sharpe Ratio: {portfolio_data[\"performance_metrics\"][\"sharpe_ratio\"]:.2f}\n\n  Right - Bar chart of top 5 holdings by value:\n  {\", \".join([f\"{h['ticker']}: ${h['market_value']:,.0f}\" for h in top_holdings.to_dict(\"records\")])}\n\nSlide 3 - Sector Allocation:\n- Title: \"Asset Allocation & Diversification\"\n- Pie chart showing:\n  Technology: {sector_allocation[\"Technology\"]:.1f}%\n  Financials: {sector_allocation[\"Financials\"]:.1f}%\n  Healthcare: {sector_allocation[\"Healthcare\"]:.1f}%\n  Consumer: {sector_allocation[\"Consumer Discretionary\"] + sector_allocation[\"Consumer Staples\"]:.1f}%\n  Fixed Income: {sector_allocation[\"Bonds\"]:.1f}%\n  Cash: {sector_allocation[\"Cash\"]:.1f}%\n\nSlide 4 - Risk Analysis:\n- Title: \"Risk Metrics & Analysis\"\n- Content:\n  Risk Indicators:\n  \u2022 Portfolio Beta: {portfolio_data[\"performance_metrics\"][\"beta\"]:.2f} (lower market risk)\n  \u2022 Standard Deviation: {portfolio_data[\"performance_metrics\"][\"standard_deviation\"]:.1f}%\n  \u2022 Maximum Drawdown: -12.3%\n  \u2022 Value at Risk (95%): $62,500\n\n  Risk-Adjusted Performance:\n  \u2022 Sharpe Ratio: {portfolio_data[\"performance_metrics\"][\"sharpe_ratio\"]:.2f} (excellent)\n  \u2022 Alpha Generation: +2.3% vs benchmark\n\nSlide 5 - Recommendations:\n- Title: \"Strategic Recommendations\"\n- Bullet points:\n  \u2713 Maintain current allocation - well diversified\n  \u2713 Consider profit-taking in Technology (20% \u2192 18%)\n  \u2713 Increase Healthcare allocation (8.7% \u2192 10%)\n  \u2713 Monitor bond duration given rate environment\n  \u2713 Rebalance quarterly to maintain targets\n\nUse professional investment presentation design.\n\"\"\"\n\n# Create investment committee deck\ninvestment_response, investment_results = create_skills_message(\n    client,\n    investment_deck_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"pptx\", \"version\": \"latest\"}],\n    prefix=\"investment_committee_\",\n)\n\nprint(\"\\n\" + \"=\" * 60)\nprint_download_summary(investment_results)\nprint(\"\\n\u2705 Investment committee presentation created successfully!\")\n```\n\n---\n\n# Cell 22 (markdown)\n## 4. Use Case 3: Automated Reporting Pipeline {#reporting-pipeline}\n\nSo far, we've created individual documents for specific purposes. Now let's demonstrate the power of chaining multiple Skills together in an automated workflow. This pipeline pattern is essential for production systems where you need to generate multiple related documents from the same data source.\n\nIn this example, we'll create a complete reporting suite that:\n1. **Analyzes data** in Excel with calculations and charts\n2. **Summarizes insights** in a PowerPoint presentation\n3. **Documents the process** in a formal PDF report\n\nThis showcases how Skills can work together to create a comprehensive reporting solution that would traditionally require multiple tools and manual coordination.\n\n**Key benefits of the pipeline approach:**\n- Consistent data across all documents\n- Reduced total generation time\n- Token usage optimization\n- Scalable to multiple report types\n\n**\u23f1\ufe0f Total expected time:** 2-3 minutes for the complete pipeline\n\n---\n\n# Cell 23 (code)\n```python\nprint(\"\ud83d\udd04 Starting Automated Reporting Pipeline\")\nprint(\"=\" * 60)\nprint(\"This will create a complete reporting suite:\")\nprint(\"1. Excel analysis \u2192 2. PowerPoint summary \u2192 3. PDF documentation\")\nprint(\"\\n\u23f1\ufe0f Total pipeline time: 2-3 minutes\\n\")\n\n# Track token usage across the pipeline\npipeline_tokens = {\"input\": 0, \"output\": 0}\n\n# Step 1: Create Excel Analysis\nprint(\"Step 1/3: Creating Excel analysis with quarterly metrics...\")\n\nexcel_pipeline_prompt = f\"\"\"\nCreate a quarterly business metrics Excel file:\n\nSheet 1 - \"Quarterly KPIs\":\nCreate a table with these quarterly metrics for 2024:\n{\n    json.dumps(\n        [\n            {\n                k: v\n                for k, v in q.items()\n                if k in [\"quarter\", \"revenue\", \"gross_margin\", \"customer_count\", \"churn_rate\"]\n            }\n            for q in quarterly_metrics[\"quarters\"]\n        ],\n        indent=2,\n    )\n}\n\nAdd:\n- Quarter-over-quarter growth calculations\n- Average and total rows\n- Conditional formatting for trends\n- Line chart showing revenue trend\n- Column chart showing customer count\n\nSheet 2 - \"YoY Comparison\":\nCompare Q4 2024 vs Q4 2023 for all metrics.\nCalculate percentage changes and highlight improvements.\n\nProfessional formatting with headers and borders.\n\"\"\"\n\nexcel_response, excel_results = create_skills_message(\n    client,\n    excel_pipeline_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"xlsx\", \"version\": \"latest\"}],\n    prefix=\"pipeline_1_metrics_\",\n    show_token_usage=False,\n)\n\npipeline_tokens[\"input\"] += excel_response.usage.input_tokens\npipeline_tokens[\"output\"] += excel_response.usage.output_tokens\nprint(\n    f\"\u2713 Excel created - Tokens: {excel_response.usage.input_tokens} in, {excel_response.usage.output_tokens} out\"\n)\n\n# Step 2: Create PowerPoint Summary\nprint(\"\\nStep 2/3: Creating PowerPoint summary from metrics...\")\n\nppt_pipeline_prompt = \"\"\"\nCreate a 3-slide quarterly metrics summary presentation:\n\nSlide 1:\n- Title: \"Q4 2024 Metrics Summary\"\n- Subtitle: \"Automated Reporting Pipeline Demo\"\n\nSlide 2:\n- Title: \"Key Performance Indicators\"\n- Show Q4 2024 metrics:\n  \u2022 Revenue: $3.2M (+15% QoQ)\n  \u2022 Customers: 850 (+8.9% QoQ)\n  \u2022 Gross Margin: 72%\n  \u2022 Churn Rate: 2.8% (improved from 3.5%)\n- Add a simple bar chart comparing Q3 vs Q4 revenue\n\nSlide 3:\n- Title: \"Quarterly Trend Analysis\"\n- Line chart showing revenue growth Q1-Q4\n- Key insight bullets:\n  \u2022 Consistent QoQ growth\n  \u2022 Customer acquisition accelerating\n  \u2022 Churn reduction successful\n\nClean, data-focused design.\n\"\"\"\n\nppt_response, ppt_results = create_skills_message(\n    client,\n    ppt_pipeline_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"pptx\", \"version\": \"latest\"}],\n    prefix=\"pipeline_2_summary_\",\n    show_token_usage=False,\n)\n\npipeline_tokens[\"input\"] += ppt_response.usage.input_tokens\npipeline_tokens[\"output\"] += ppt_response.usage.output_tokens\nprint(\n    f\"\u2713 PowerPoint created - Tokens: {ppt_response.usage.input_tokens} in, {ppt_response.usage.output_tokens} out\"\n)\n\n# Step 3: Create PDF Documentation\nprint(\"\\nStep 3/3: Creating PDF documentation...\")\n\npdf_pipeline_prompt = \"\"\"\nCreate a PDF document summarizing the quarterly reporting pipeline:\n\nAUTOMATED REPORTING PIPELINE\nQ4 2024 Results Documentation\n\nEXECUTIVE SUMMARY\nThis document summarizes the Q4 2024 business metrics generated through\nour automated reporting pipeline.\n\nKEY METRICS\n- Revenue: $3.2M (15% QoQ growth)\n- Customer Base: 850 active customers\n- Gross Margin: 72%\n- Churn Rate: 2.8% (improved from 3.5%)\n\nPIPELINE COMPONENTS\n1. Data Processing: Quarterly metrics analyzed in Excel\n2. Visualization: Key insights presented in PowerPoint\n3. Documentation: Formal report generated in PDF\n\nAUTOMATION BENEFITS\n\u2022 Reduced reporting time by 90%\n\u2022 Consistent format and quality\n\u2022 Eliminated manual errors\n\u2022 Scalable to multiple reports\n\nNEXT STEPS\n- Expand pipeline to include predictive analytics\n- Add automated email distribution\n- Implement real-time data feeds\n\nGenerated: January 2025\nPipeline Version: 1.0\n\nFormat as a professional technical document.\n\"\"\"\n\npdf_response, pdf_results = create_skills_message(\n    client,\n    pdf_pipeline_prompt,\n    [{\"type\": \"anthropic\", \"skill_id\": \"pdf\", \"version\": \"latest\"}],\n    prefix=\"pipeline_3_documentation_\",\n    show_token_usage=False,\n)\n\npipeline_tokens[\"input\"] += pdf_response.usage.input_tokens\npipeline_tokens[\"output\"] += pdf_response.usage.output_tokens\nprint(\n    f\"\u2713 PDF created - Tokens: {pdf_response.usage.input_tokens} in, {pdf_response.usage.output_tokens} out\"\n)\n\n# Pipeline Summary\nprint(\"\\n\" + \"=\" * 60)\nprint(\"\ud83c\udfaf PIPELINE COMPLETE!\")\nprint(\"=\" * 60)\n\nprint(\"\\n\ud83d\udcca Pipeline Token Usage Summary:\")\nprint(f\"   Total Input Tokens: {pipeline_tokens['input']:,}\")\nprint(f\"   Total Output Tokens: {pipeline_tokens['output']:,}\")\nprint(f\"   Total Tokens: {pipeline_tokens['input'] + pipeline_tokens['output']:,}\")\nprint(f\"   Average per document: {(pipeline_tokens['input'] + pipeline_tokens['output']) // 3:,}\")\n\nprint(\"\\n\ud83d\udcc1 Generated Files:\")\nall_results = excel_results + ppt_results + pdf_results\nfor i, result in enumerate(all_results, 1):\n    if result[\"success\"]:\n        print(f\"   {i}. {os.path.basename(result['output_path'])} ({result['size'] / 1024:.1f} KB)\")\n\nprint(\"\\n\u2705 Automated reporting pipeline executed successfully!\")\nprint(\"   All three documents created and linked in workflow.\")\n```\n\n---\n\n# Cell 24 (markdown)\n## Summary & Next Steps\n\n### What We've Accomplished\n\nIn this notebook, you've learned how to:\n\n\u2705 **Financial Dashboard Creation**\n- Built multi-sheet Excel models with formulas and charts\n- Generated executive PowerPoint presentations\n- Created professional PDF reports\n\n\u2705 **Portfolio Analysis**\n- Developed portfolio analytics workbooks\n- Created investment committee presentations\n- Implemented risk metrics and rebalancing tools\n\n\u2705 **Automated Pipelines**\n- Chained multiple document formats\n- Optimized token usage\n- Built production-ready patterns\n\n### Key Takeaways\n\n1. **Skills dramatically simplify financial document creation** - What would take hours manually takes minutes\n2. **Token efficiency is excellent** - Skills use ~90% fewer tokens than manual instructions\n3. **Quality is professional-grade** - Documents are immediately usable in business contexts\n4. **Automation is straightforward** - Pipeline patterns enable complex workflows\n\n### Continue Your Learning\n\n\ud83d\udcda **Next: [Notebook 3 - Custom Skills Development](03_skills_custom_development.ipynb)**\n- Build your own specialized financial skills\n- Create company-specific templates\n- Implement advanced automation\n\n### Try These Experiments\n\n1. **Modify the financial dashboard** to include your own metrics\n2. **Create a custom portfolio** with different asset classes\n3. **Build a pipeline** for your specific reporting needs\n4. **Experiment with complexity** to understand generation times\n5. **Track token usage** across different document types\n\n### Resources\n\n- [Claude API Documentation](https://docs.anthropic.com/en/api/messages)\n- [Skills Documentation](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/overview)\n- [Best Practices](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/best-practices)\n- [Files API Reference](https://docs.claude.com/en/api/files-content)\n\n---\n\n"
  ]
}