{
  "session_id": "4f547ddd-0fff-4217-9f82-b624b605c266",
  "prompts": [
    "/bug 39 ef0fbb01 {\"number\": \"39\", \"title\": \"Hardcoded issue provider\", \"body\": \"Let's review and fix all workflows to ensure compatibility with various issue providers.\\n\\n---\\ntitle: \\\"adw_review_iso.py does not support GitLab - hardcoded to GitHub\\\"\\nstatus: open\\nlabels:\\n  - bug\\n  - gitlab\\n  - adw\\ncreated_at: 2024-12-09T00:00:00\\nupdated_at: 2024-12-09T00:00:00\\nagent_updates: []\\n---\\n\\n## Summary\\n\\n`adw_review_iso.py` fails to detect GitLab issues because it directly imports from `github.py` instead of using the platform-agnostic `issue_providers` module.\\n\\n## Reproduction\\n\\n```bash\\n# In a GitLab-hosted repository\\nuv run adws/adw_review_iso.py 2 3f9d30d1 --skip-resolution\\n```\\n\\n**Expected:** Issue #2 is fetched from GitLab and review workflow proceeds.\\n\\n**Actual:** Fails to detect the GitLab issue because the workflow uses `gh` CLI (GitHub CLI) instead of `glab` CLI.\\n\\n## Root Cause\\n\\n`adw_review_iso.py` (lines 40-45) directly imports GitHub-specific functions:\\n\\n```python\\nfrom adws.adw_modules.github import (\\n    fetch_issue,\\n    make_issue_comment,\\n    get_repo_url,\\n    extract_repo_path,\\n)\\n```\\n\\nThis bypasses the platform detection logic in `issue_providers.py` that other workflows use.\\n\\n## Comparison with Working Workflows\\n\\n`adw_plan_iso.py` and `adw_build_iso.py` correctly support both platforms by:\\n\\n1. Using `resolve_issue()` from `issue_providers.py` to auto-detect platform from git remote\\n2. Using `get_provider_for_issue()` for posting comments\\n3. Conditionally handling GitHub PRs vs GitLab MRs in the finalization step\\n\\nExample from `adw_plan_iso.py`:\\n```python\\nfrom adws.adw_modules.issue_providers import resolve_issue, get_provider_for_issue\\nfrom adws.adw_modules.code_review_providers import GitLabCodeReviewProvider\\n\\n# Auto-detect platform and fetch issue\\nissue = resolve_issue(issue_number)\\n\\n# Use appropriate provider for comments\\nprovider = get_provider_for_issue(issue)\\nprovider.add_comment(issue, \\\"Starting planning phase...\\\")\\n\\n# Handle GitLab MRs\\nif issue.source == IssueSource.GITLAB:\\n    gitlab_provider = GitLabCodeReviewProvider(project_path=issue.repo_path, logger=logger)\\n    # ... create/update MR\\n```\\n\\n## Proposed Fix\\n\\n1. Replace `github.py` imports with platform-agnostic modules:\\n   ```python\\n   from adws.adw_modules.issue_providers import resolve_issue, get_provider_for_issue\\n   from adws.adw_modules.git_ops import get_repo_url, extract_repo_path, detect_git_platform\\n   from adws.adw_modules.gitlab import extract_project_path\\n   from adws.adw_modules.code_review_providers import GitLabCodeReviewProvider\\n   ```\\n\\n2. Use `resolve_issue()` instead of direct `fetch_issue()` call (line 497)\\n\\n3. Replace `make_issue_comment()` calls with provider-based approach:\\n   ```python\\n   provider = get_provider_for_issue(issue)\\n   provider.add_comment(issue, message)\\n   ```\\n\\n4. Add GitLab MR handling in the finalization step (similar to `adw_build_iso.py` lines 337-369)\\n\\n## Files to Modify\\n\\n- `/Users/ameno/dev/ask-anna-ai/adws/adw_review_iso.py`\\n\\n## Related Files (Reference Implementation)\\n\\n- `adws/adw_plan_iso.py` - Has working GitLab support\\n- `adws/adw_build_iso.py` - Has working GitLab support\\n- `adws/adw_modules/issue_providers.py` - Platform-agnostic issue resolution\\n- `adws/adw_modules/gitlab.py` - GitLab-specific operations\\n- `adws/adw_modules/notification_providers.py` - Platform-agnostic notifications\\n\\n## Environment\\n\\n- Repository: `git@gitlab.com:ameno13/ask-anna-ai.git`\\n- Platform: GitLab\\n- Jerry version: Current main branch\\n\"}"
  ]
}