{
  "session_id": "82a6e6d1-55b1-48d2-9a8a-a856d005fdd0",
  "prompts": [
    "# IDENTITY and PURPOSE\n\nYou are an expert technical content extractor specializing in identifying code, tools, frameworks, commands, configurations, and technical resources from developer-focused content.\n\nTake a step back and think step-by-step about how to extract all technical elements that would be valuable for developers implementing the discussed concepts.\n\n# STEPS\n\n- Identify all programming languages, frameworks, and tools mentioned\n- Extract code snippets, commands, and configurations with context\n- Capture setup instructions and dependencies\n- Extract repository links, documentation, and external resources\n- Note technical concepts and architectural patterns discussed\n- Identify potential automation opportunities\n\n# OUTPUT INSTRUCTIONS\n\n- Only output Markdown\n- All sections are required (use \"None identified\" if a section has no content)\n- Format code snippets with proper markdown code blocks and language identifiers\n- Include line numbers or timestamps where snippets appear if available\n- Ensure all URLs and links are complete and clickable\n- Do not give warnings or notes; only output the requested sections\n\n# OUTPUT SECTIONS\n\n## TECH_STACK\n\n### Languages\n- [Language name] - [Context of use]\n\n### Frameworks & Libraries\n- [Framework/library name] - [Version if mentioned] - [Purpose/use case]\n\n### Tools & Platforms\n- [Tool name] - [Purpose] - [Link if mentioned]\n\n### Services & APIs\n- [Service name] - [Integration context]\n\n## CODE_SNIPPETS\n\n### Snippet [N]: [Brief description]\n**Context**: [When/why this code appears]\n**Timestamp**: [HH:MM:SS if available]\n\n```[language]\n[Code snippet exactly as shown/discussed]\n```\n\n**Explanation**: [What this code does]\n**Key Points**: [Important details or gotchas]\n\n[Repeat for each snippet]\n\n## COMMANDS & SCRIPTS\n\n### Installation & Setup\n```bash\n[Installation commands]\n```\n\n### Configuration\n```bash\n[Configuration commands]\n```\n\n### Execution & Testing\n```bash\n[Runtime commands]\n```\n\n### Deployment\n```bash\n[Deployment commands if discussed]\n```\n\n## TECHNICAL_CONCEPTS\n\n### Architectural Patterns\n- [Pattern name]: [Brief explanation] - [Why it's used]\n\n### Design Principles\n- [Principle]: [How it's applied]\n\n### Best Practices\n- [Practice]: [Context and reasoning]\n\n### Common Pitfalls\n- [Pitfall]: [How to avoid]\n\n## DEPENDENCIES & REQUIREMENTS\n\n### System Requirements\n- [Requirement]: [Specification]\n\n### Package Dependencies\n- [Package name]: [Version] - [Purpose]\n\n### Environment Variables\n```bash\n[Variable name]=[Description of value needed]\n```\n\n### Prerequisites\n- [Prerequisite]: [Why it's needed]\n\n## RESOURCES & LINKS\n\n### Official Documentation\n- [Resource name]: [URL]\n\n### Repository Links\n- [Repo name]: [URL] - [What it contains]\n\n### Related Tools & Extensions\n- [Tool name]: [URL] - [Purpose]\n\n### Learning Resources\n- [Resource]: [URL] - [What you'll learn]\n\n### Community & Support\n- [Community/Forum]: [URL]\n\n## CONFIGURATION_FILES\n\n### [Filename]\n**Purpose**: [What this config does]\n**Location**: [Where to place it]\n\n```[format]\n[Configuration content]\n```\n\n[Repeat for each config file]\n\n## WORKFLOW_STEPS\n\n### Setup Process\n1. [Step with relevant commands/actions]\n2. [Step with relevant commands/actions]\n\n### Development Workflow\n1. [Step with relevant commands/actions]\n2. [Step with relevant commands/actions]\n\n### Testing & Validation\n1. [Step with relevant commands/actions]\n2. [Step with relevant commands/actions]\n\n### Deployment Process\n1. [Step with relevant commands/actions]\n2. [Step with relevant commands/actions]\n\n## AUTOMATION_OPPORTUNITIES\n\n- [Workflow that could be automated]: [How it could be automated]\n- [Repetitive task]: [Automation approach]\n- [Manual process]: [Script/tool that could help]\n\n## TECHNICAL_NOTES\n\n### Performance Considerations\n- [Note about performance implications]\n\n### Security Considerations\n- [Security best practices or warnings]\n\n### Compatibility Notes\n- [Version compatibility or platform-specific notes]\n\n### Troubleshooting Tips\n- [Common issue]: [Solution]\n\n## QUICK_REFERENCE\n\n### Essential Commands\n```bash\n# [Description]\n[command]\n\n# [Description]\n[command]\n```\n\n### Key File Locations\n- [File/directory]: [Path] - [Purpose]\n\n### Important URLs\n- [Purpose]: [URL]\n\n# INPUT\n\nINPUT:\n\n\n# INPUT\n\n# Cell 1 (markdown)\n# Introduction to Claude Skills\n\nLearn how to use Claude's Skills feature to create professional documents, analyze data, and automate business workflows with Excel, PowerPoint, and PDF generation.\n\n> **See it in action:** The Skills you'll learn about power Claude's file creation capabilities! Check out **[Claude Creates Files](https://www.anthropic.com/news/create-files)** to see how these Skills enable Claude to create and edit documents directly in Claude.ai.\n\n---\n\n# Cell 2 (markdown)\n## Table of Contents\n\n1. [Setup & Installation](#setup)\n2. [Understanding Skills](#understanding)\n3. [Discovering Available Skills](#discovering)\n4. [Quick Start: Excel](#excel-quickstart)\n5. [Quick Start: PowerPoint](#powerpoint-quickstart)\n6. [Quick Start: PDF](#pdf-quickstart)\n7. [Troubleshooting](#troubleshooting)\n\n---\n\n# Cell 3 (markdown)\n## 1. Setup & Installation {#setup}\n\n### Prerequisites\n\nBefore starting, make sure you have:\n- Python 3.8 or higher\n- An Anthropic API key from [console.anthropic.com](https://console.anthropic.com/)\n\n### Environment Setup (First Time Only)\n\n**If you haven't set up your environment yet**, follow these steps:\n\n#### Step 1: Create Virtual Environment\n\n```bash\n# Navigate to the skills directory\ncd /path/to/claude-cookbooks/skills\n\n# Create virtual environment\npython -m venv venv\n\n# Activate it\nsource venv/bin/activate  # On macOS/Linux\n# OR\nvenv\\Scripts\\activate     # On Windows\n```\n\n#### Step 2: Install Dependencies\n\n```bash\n# With venv activated, install requirements\npip install -r requirements.txt\n```\n\n#### Step 3: Select Kernel in VSCode/Jupyter\n\n**In VSCode:**\n1. Open this notebook\n2. Click the kernel picker in the top-right (e.g., \"Python 3.11.x\")\n3. Select \"Python Environments...\"\n4. Choose the `./venv/bin/python` interpreter\n\n**In Jupyter:**\n1. From the Kernel menu \u2192 Change Kernel\n2. Select the kernel matching your venv\n\n#### Step 4: Configure API Key\n\n```bash\n# Copy the example file\ncp .env.example .env\n\n# Edit .env and add your API key:\n# ANTHROPIC_API_KEY=sk-ant-api03-...\n```\n\n### Quick Installation Check\n\nRun the cell below to verify your environment is set up correctly:\n\n---\n\n# Cell 4 (markdown)\n**If you see any \u274c or \u26a0\ufe0f warnings above**, please complete the setup steps before continuing.\n\n**If anthropic SDK version is too old (needs 0.71.0 or later):**\n```bash\npip install anthropic>=0.71.0\n```\nThen **restart the Jupyter kernel** to pick up the new version.\n\n---\n\n### API Configuration\n\nNow let's load the API key and configure the client:\n\n---\n\n# Cell 5 (markdown)\n### API Configuration\n\n**\u26a0\ufe0f Important**: Create a `.env` file in the skills directory:\n\n```bash\n# Copy the example file\ncp ../.env.example ../.env\n```\n\nThen edit `../.env` to add your Anthropic API key.\n\n---\n\n# Cell 6 (code)\n```python\nimport os\nimport sys\nfrom pathlib import Path\n\n# Add parent directory to path for imports\nsys.path.insert(0, str(Path.cwd().parent))\n\n\nfrom anthropic import Anthropic\nfrom dotenv import load_dotenv\n\n# Import our file utilities\nfrom file_utils import (\n    download_all_files,\n    extract_file_ids,\n    get_file_info,\n    print_download_summary,\n)\n\n# Load environment variables from parent directory\nload_dotenv(Path.cwd().parent / \".env\")\n\nAPI_KEY = os.getenv(\"ANTHROPIC_API_KEY\")\nMODEL = os.getenv(\"ANTHROPIC_MODEL\", \"claude-sonnet-4-5\")\n\nif not API_KEY:\n    raise ValueError(\n        \"ANTHROPIC_API_KEY not found. Copy ../.env.example to ../.env and add your API key.\"\n    )\n\n# Initialize client\n# Note: We'll add beta headers per-request when using Skills\nclient = Anthropic(api_key=API_KEY)\n\n# Create outputs directory if it doesn't exist\nOUTPUT_DIR = Path.cwd().parent / \"outputs\"\nOUTPUT_DIR.mkdir(exist_ok=True)\n\nprint(\"\u2713 API key loaded\")\nprint(f\"\u2713 Using model: {MODEL}\")\nprint(f\"\u2713 Output directory: {OUTPUT_DIR}\")\nprint(\"\\n\ud83d\udcdd Note: Beta headers will be added per-request when using Skills\")\n```\n\n---\n\n# Cell 7 (markdown)\n### Test Connection\n\nLet's verify our API connection works:\n\n---\n\n# Cell 8 (code)\n```python\n# Simple test to verify API connection\ntest_response = client.messages.create(\n    model=MODEL,\n    max_tokens=100,\n    messages=[\n        {\n            \"role\": \"user\",\n            \"content\": \"Say 'Connection successful!' if you can read this.\",\n        }\n    ],\n)\n\nprint(\"API Test Response:\")\nprint(test_response.content[0].text)\nprint(\n    f\"\\n\u2713 Token usage: {test_response.usage.input_tokens} in, {test_response.usage.output_tokens} out\"\n)\n```\n\n---\n\n# Cell 9 (markdown)\n## 2. Understanding Skills {#understanding}\n\n### What are Skills?\n\n**Skills** are organized packages of instructions, executable code, and resources that give Claude specialized capabilities for specific tasks. Think of them as \"expertise packages\" that Claude can discover and load dynamically.\n\n\ud83d\udcd6 Read our engineering blog post on [Equipping agents for the real world with Skills](https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)\n\n### Why Skills Matter\n\nAfter learning about MCPs (Model Context Protocol) and tools, you might wonder why Skills are important:\n\n- **Skills are higher-level** than individual tools - they combine instructions, code, and resources\n- **Skills are composable** - multiple skills work together seamlessly\n- **Skills are efficient** - progressive disclosure means you only pay for what you use\n- **Skills include proven code** - helper scripts that work reliably, saving time and reducing errors\n\n### Key Benefits\n\n- **Expert-level Performance**: Deliver professional results without the learning curve\n- **Proven Helper Scripts**: Skills contain tested, working code that Claude can use immediately\n- **Organizational Knowledge**: Package company workflows and best practices\n- **Cost Efficiency**: Progressive disclosure minimizes token usage\n- **Reliability**: Pre-tested scripts mean fewer errors and consistent results\n- **Time Savings**: Claude uses existing solutions instead of generating code from scratch\n- **Composable**: Multiple skills work together for complex workflows\n\n### Progressive Disclosure Architecture\n\nSkills use a three-tier loading model:\n\n![Progressive Disclosure - How Skills Load](../assets/prog-disc-1.png)\n\n1. **Metadata** (name: 64 chars, description: 1024 chars): Claude sees skill name and description\n2. **Full Instructions** (<5k tokens): Loaded when skill is relevant\n3. **Linked Files**: Additional resources loaded only if needed\n\n![Progressive Disclosure Stages](../assets/prog-disc-2.png)\n\nThis keeps operations efficient while providing deep expertise on demand. Initially, Claude sees just the metadata from the YAML frontmatter of SKILL.md. Only when a skill is relevant does Claude load the full contents, including any helper scripts and resources.\n\n### Skill Types\n\n| Type | Description | Example |\n|------|-------------|----------|\n| **Anthropic-Managed** | Pre-built skills maintained by Anthropic | `xlsx`, `pptx`, `pdf`, `docx` |\n| **Custom** | User-defined skills for specific workflows | Brand guidelines, financial models |\n\n---\n\n# Cell 10 (markdown)\n### Skills Conceptual Overview\n\n![Skills Conceptual Diagram](../assets/skills-conceptual-diagram.png)\n\nThis diagram illustrates:\n- **Skill Directory Structure**: How Skills are organized with SKILL.md and supporting files\n- **YAML Frontmatter**: The metadata that Claude sees initially\n- **Progressive Loading**: How Skills are discovered and loaded on-demand\n- **Composability**: Multiple Skills working together in a single request\n\n---\n\n# Cell 11 (markdown)\n### How Skills Work with Code Execution\n\nSkills require the **code execution** tool to be enabled. Here's the typical workflow:\n\n```python\n# Use client.beta.messages.create() for Skills support\nresponse = client.beta.messages.create(\n    model=\"claude-sonnet-4-5\",\n    max_tokens=4096,\n    container={\n        \"skills\": [\n            {\"type\": \"anthropic\", \"skill_id\": \"xlsx\", \"version\": \"latest\"}\n        ]\n    },\n    tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n    messages=[{\"role\": \"user\", \"content\": \"Create an Excel file...\"}],\n    # Use betas parameter instead of extra_headers\n    betas=[\"code-execution-2025-08-25\", \"files-api-2025-04-14\", \"skills-2025-10-02\"]\n)\n```\n\n**What happens:**\n1. Claude receives your request with the xlsx skill loaded\n2. Claude uses code execution to create the file\n3. The response includes a `file_id` for the created file\n4. You use the **Files API** to download the file\n\n**Important: Beta API**\n- Use `client.beta.messages.create()` (not `client.messages.create()`)\n- The `container` parameter is only available in the beta API\n- Use the `betas` parameter to enable beta features:\n  - `code-execution-2025-08-25` - Enables code execution\n  - `files-api-2025-04-14` - Required for downloading files\n  - `skills-2025-10-02` - Enables Skills feature\n\n\u26a0\ufe0f **Note**: When using Skills, you MUST include the code_execution tool in your request.\n\n---\n\n# Cell 12 (markdown)\n### Token Usage Optimization\n\nSkills dramatically reduce token usage compared to providing instructions in prompts:\n\n| Approach | Token Cost | Performance |\n|----------|------------|-------------|\n| Manual instructions | 5,000-10,000 tokens/request | Variable quality |\n| Skills (metadata only) | Minimal (just name/description) | Expert-level |\n| Skills (full load) | ~5,000 tokens when skill is used | Expert-level |\n\n**The Big Win:** You can pack multiple skills into your prompt without bloating it. Each skill only costs you the metadata (name + description) until you actually use it.\n\n**Example**: Creating an Excel file with formatting\n- Without Skills: ~8,000 tokens to explain all Excel features upfront\n- With Skills: Minimal metadata overhead initially, ~5,000 tokens only when Excel skill is invoked\n- **Key Insight**: The 98% savings applies to the initial context. Once you use a skill, the full instructions are loaded.\n\n**Additional Benefits:**\n- Skills contain helper scripts that are known to work, improving reliability\n- Claude saves time by using proven code patterns instead of generating from scratch\n- You get more consistent, professional results\n\n---\n\n# Cell 13 (markdown)\n### \u23f1\ufe0f Expected Generation Times\n\n**\u26a0\ufe0f IMPORTANT**: Document generation with Skills requires code execution and file creation, which takes time. Be patient and let cells complete.\n\n**Observed generation times:**\n- **Excel files**: ~2 minutes (with charts and formatting)\n- **PowerPoint presentations**: ~1-2 minutes (simple 2-slide presentations with charts)\n- **PDF documents**: ~40-60 seconds (simple documents)\n\n**What to expect:**\n- The cell will show `[*]` while running\n- You may see \"Executing...\" status for 1-2 minutes\n- **Do not interrupt the cell** - let it complete fully\n\n**\ud83d\udca1 Recommendations:**\n1. **Start simple**: Begin with minimal examples to verify your setup\n2. **Gradually increase complexity**: Add features incrementally\n3. **Be patient**: Operations typically take 40 seconds to 2 minutes\n4. **Note**: Very complex documents may take longer - keep examples focused\n\n---\n\n# Cell 14 (markdown)\n## 3. Discovering Available Skills {#discovering}\n\n### List All Built-in Skills\n\nLet's discover what Anthropic-managed skills are available:\n\n---\n\n# Cell 15 (code)\n```python\n# List all available Anthropic skills\n# Note: Skills API requires the skills beta header\nclient_with_skills_beta = Anthropic(\n    api_key=API_KEY, default_headers={\"anthropic-beta\": \"skills-2025-10-02\"}\n)\n\nskills_response = client_with_skills_beta.beta.skills.list(source=\"anthropic\")\n\nprint(\"Available Anthropic-Managed Skills:\")\nprint(\"=\" * 80)\n\nfor skill in skills_response.data:\n    print(f\"\\n\ud83d\udce6 Skill ID: {skill.id}\")\n    print(f\"   Title: {skill.display_title}\")\n    print(f\"   Latest Version: {skill.latest_version}\")\n    print(f\"   Created: {skill.created_at}\")\n\n    # Get version details\n    try:\n        version_info = client_with_skills_beta.beta.skills.versions.retrieve(\n            skill_id=skill.id, version=skill.latest_version\n        )\n        print(f\"   Name: {version_info.name}\")\n        print(f\"   Description: {version_info.description}\")\n    except Exception as e:\n        print(f\"   (Unable to fetch version details: {e})\")\n\nprint(f\"\\n\\n\u2713 Found {len(skills_response.data)} Anthropic-managed skills\")\n```\n\n---\n\n# Cell 16 (markdown)\n### Understanding Skill Metadata\n\nEach skill has:\n- **skill_id**: Unique identifier (e.g., \"xlsx\", \"pptx\")\n- **version**: Version number or \"latest\"\n- **name**: Human-readable name\n- **description**: What the skill does\n- **directory**: Skill's folder structure\n\n### Versioning Strategy\n\n- Use `\"latest\"` for Anthropic skills (recommended)\n- Anthropic updates skills automatically\n- Pin specific versions for production stability\n- Custom skills use epoch timestamps for versions\n\n---\n\n# Cell 17 (markdown)\n### Example: Monthly Budget Spreadsheet\n\nWe'll start with two examples - a simple one-liner and a detailed request.\n\n#### Simple Example (1-2 lines)\nFirst, let's see how Skills work with a minimal prompt:\n\n```python\n# Simple prompt - Skills handle the complexity\nprompt = \"Create a quarterly sales report Excel file with revenue data and a chart\"\n```\n\n#### Detailed Example\nFor more control, you can provide specific requirements:\n- Income and expense categories\n- Formulas for totals\n- Basic formatting\n\n---\n\n# Cell 18 (markdown)\n### Example: Monthly Budget Spreadsheet\n\nWe'll create a simple budget spreadsheet with:\n- Income and expense categories\n- Formulas for totals\n- Basic formatting\n\n---\n\n# Cell 19 (markdown)\n**\u23f1\ufe0f Note**: Excel generation typically takes **1-2 minutes** (with charts and formatting). The cell will show `[*]` while running - be patient!\n\n---\n\n# Cell 20 (code)\n```python\n# Create an Excel budget spreadsheet\nexcel_response = client.beta.messages.create(  # Note: Using beta.messages for Skills support\n    model=MODEL,\n    max_tokens=4096,\n    container={\"skills\": [{\"type\": \"anthropic\", \"skill_id\": \"xlsx\", \"version\": \"latest\"}]},\n    tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n    messages=[\n        {\n            \"role\": \"user\",\n            \"content\": \"\"\"Create a monthly budget Excel spreadsheet with the following:\n\nIncome:\n- Salary: $5,000\n- Freelance: $1,200\n- Investments: $300\n\nExpenses:\n- Rent: $1,500\n- Utilities: $200\n- Groceries: $600\n- Transportation: $300\n- Entertainment: $400\n- Savings: $1,000\n\nInclude:\n1. Formulas to calculate total income and total expenses\n2. A formula for net savings (income - expenses)\n3. Format currency values properly\n4. Add a simple column chart showing income vs expenses\n5. Use professional formatting with headers\n\"\"\",\n        }\n    ],\n    # Use betas parameter for beta features\n    betas=[\"code-execution-2025-08-25\", \"files-api-2025-04-14\", \"skills-2025-10-02\"],\n)\n\nprint(\"Excel Response:\")\nprint(\"=\" * 80)\nfor content in excel_response.content:\n    if content.type == \"text\":\n        print(content.text)\n    elif content.type == \"tool_use\":\n        print(f\"\\n\ud83d\udd27 Tool: {content.name}\")\n        if hasattr(content, \"input\"):\n            print(f\"   Input preview: {str(content.input)[:200]}...\")\n\nprint(\"\\n\\n\ud83d\udcca Token Usage:\")\nprint(f\"   Input: {excel_response.usage.input_tokens}\")\nprint(f\"   Output: {excel_response.usage.output_tokens}\")\n```\n\n---\n\n# Cell 21 (markdown)\n### Download the Excel File\n\nNow let's extract the file_id and download the generated Excel file:\n\n---\n\n# Cell 22 (code)\n```python\n# Extract file IDs from the response\nfile_ids = extract_file_ids(excel_response)\n\nif file_ids:\n    print(f\"\u2713 Found {len(file_ids)} file(s)\\n\")\n\n    # Download all files\n    results = download_all_files(\n        client, excel_response, output_dir=str(OUTPUT_DIR), prefix=\"budget_\"\n    )\n\n    # Print summary\n    print_download_summary(results)\n\n    # Show file details\n    for file_id in file_ids:\n        info = get_file_info(client, file_id)\n        if info:\n            print(\"\\n\ud83d\udcc4 File Details:\")\n            print(f\"   Filename: {info['filename']}\")\n            print(f\"   Size: {info['size'] / 1024:.1f} KB\")\n            print(f\"   Created: {info['created_at']}\")\nelse:\n    print(\"\u274c No files found in response\")\n    print(\"\\nDebug: Response content types:\")\n    for i, content in enumerate(excel_response.content):\n        print(f\"  {i}. {content.type}\")\n```\n\n---\n\n# Cell 23 (markdown)\n**\u2728 What just happened?**\n\n1. Claude used the `xlsx` skill to create a professional Excel file\n2. The skill handled all Excel-specific formatting and formulas\n3. The file was created in Claude's code execution environment\n4. We extracted the `file_id` from the response\n5. We downloaded the file using the Files API\n6. The file is now saved in `outputs/budget_*.xlsx`\n\nOpen the file in Excel to see the results!\n\n---\n\n# Cell 24 (markdown)\n## 5. Quick Start: PowerPoint {#powerpoint-quickstart}\n\nNow let's create a PowerPoint presentation using the `pptx` skill.\n\n---\n\n# Cell 25 (markdown)\n### Example: Revenue Presentation\n\n#### Simple Example (1 line)\n```python\n# Minimal prompt - let Skills handle the details\nprompt = \"Create an executive summary presentation with 3 slides about Q3 results\"\n```\n\n#### Detailed Example\n**Note**: This is intentionally kept simple (2 slides, 1 chart) to minimize generation time and demonstrate the core functionality.\n\n---\n\n# Cell 26 (markdown)\n### Example: Simple Revenue Presentation\n\n**Note**: This is intentionally kept simple (2 slides, 1 chart) to minimize generation time and demonstrate the core functionality.\n\n---\n\n# Cell 27 (code)\n```python\n# Create a PowerPoint presentation\npptx_response = client.beta.messages.create(\n    model=MODEL,\n    max_tokens=4096,\n    container={\"skills\": [{\"type\": \"anthropic\", \"skill_id\": \"pptx\", \"version\": \"latest\"}]},\n    tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n    messages=[\n        {\n            \"role\": \"user\",\n            \"content\": \"\"\"Create a simple 2-slide PowerPoint presentation:\n\nSlide 1: Title slide\n- Title: \"Q3 2025 Results\"\n- Subtitle: \"Acme Corporation\"\n\nSlide 2: Revenue Overview\n- Title: \"Quarterly Revenue\"\n- Add a simple column chart showing:\n  - Q1: $12M\n  - Q2: $13M\n  - Q3: $14M\n\nUse clean, professional formatting.\n\"\"\",\n        }\n    ],\n    betas=[\"code-execution-2025-08-25\", \"files-api-2025-04-14\", \"skills-2025-10-02\"],\n)\n\nprint(\"PowerPoint Response:\")\nprint(\"=\" * 80)\nfor content in pptx_response.content:\n    if content.type == \"text\":\n        print(content.text)\n\nprint(\"\\n\\n\ud83d\udcca Token Usage:\")\nprint(f\"   Input: {pptx_response.usage.input_tokens}\")\nprint(f\"   Output: {pptx_response.usage.output_tokens}\")\n```\n\n---\n\n# Cell 28 (markdown)\n### Download the PowerPoint File\n\n---\n\n# Cell 29 (code)\n```python\n# Download the PowerPoint file\nfile_ids = extract_file_ids(pptx_response)\n\nif file_ids:\n    results = download_all_files(\n        client, pptx_response, output_dir=str(OUTPUT_DIR), prefix=\"q3_review_\"\n    )\n\n    print_download_summary(results)\n\n    print(\"\\n\u2705 Open the presentation in PowerPoint or Google Slides to view!\")\nelse:\n    print(\"\u274c No files found in response\")\n```\n\n---\n\n# Cell 30 (markdown)\n**\u23f1\ufe0f Note**: PDF generation typically takes **1-2 minutes** for simple documents. The cell will show `[*]` while running - be patient!\n\n---\n\n# Cell 31 (markdown)\n### Example: PDF Documents\n\n#### Simple Example (1 line)\n```python\n# Quick PDF generation\nprompt = \"Create a professional invoice PDF for $500 consulting services\"\n```\n\n#### Detailed Example: Receipt\n**Note**: This is intentionally kept simple to ensure clean formatting.\n\n---\n\n# Cell 32 (markdown)\n### Example: Simple Receipt\n\n**Note**: This is intentionally kept simple to ensure clean formatting.\n\n---\n\n# Cell 33 (code)\n```python\n# Create a PDF receipt\npdf_response = client.beta.messages.create(\n    model=MODEL,\n    max_tokens=4096,\n    container={\"skills\": [{\"type\": \"anthropic\", \"skill_id\": \"pdf\", \"version\": \"latest\"}]},\n    tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n    messages=[\n        {\n            \"role\": \"user\",\n            \"content\": \"\"\"Create a simple receipt PDF:\n\nRECEIPT\n\nAcme Corporation\nDate: January 15, 2025\nReceipt #: RCT-2025-001\n\nCustomer: Jane Smith\n\nItems:\n- Product A: $50.00\n- Product B: $75.00\n- Product C: $25.00\n\nSubtotal: $150.00\nTax (8%): $12.00\nTotal: $162.00\n\nThank you for your business!\n\nUse simple, clean formatting with clear sections.\n\"\"\",\n        }\n    ],\n    betas=[\"code-execution-2025-08-25\", \"files-api-2025-04-14\", \"skills-2025-10-02\"],\n)\n\nprint(\"PDF Response:\")\nprint(\"=\" * 80)\nfor content in pdf_response.content:\n    if content.type == \"text\":\n        print(content.text)\n\nprint(\"\\n\\n\ud83d\udcca Token Usage:\")\nprint(f\"   Input: {pdf_response.usage.input_tokens}\")\nprint(f\"   Output: {pdf_response.usage.output_tokens}\")\n```\n\n---\n\n# Cell 34 (markdown)\n### Download and Verify the PDF\n\n---\n\n# Cell 35 (code)\n```python\n# Download the PDF file\nfile_ids = extract_file_ids(pdf_response)\n\nif file_ids:\n    results = download_all_files(\n        client, pdf_response, output_dir=str(OUTPUT_DIR), prefix=\"receipt_\"\n    )\n\n    print_download_summary(results)\n\n    # Verify PDF integrity\n    for result in results:\n        if result[\"success\"]:\n            file_path = result[\"output_path\"]\n            file_size = result[\"size\"]\n\n            # Basic PDF validation\n            with open(file_path, \"rb\") as f:\n                header = f.read(5)\n                if header == b\"%PDF-\":\n                    print(f\"\\n\u2705 PDF file is valid: {file_path}\")\n                    print(f\"   File size: {file_size / 1024:.1f} KB\")\n                else:\n                    print(f\"\\n\u26a0\ufe0f File may not be a valid PDF: {file_path}\")\nelse:\n    print(\"\u274c No files found in response\")\n```\n\n---\n\n# Cell 36 (markdown)\n## 7. Troubleshooting {#troubleshooting}\n\n### Common Issues and Solutions\n\n---\n\n# Cell 37 (markdown)\n### Issue 1: API Key Not Found\n\n**Error:**\n```\nValueError: ANTHROPIC_API_KEY not found\n```\n\n**Solution:**\n1. Ensure `.env` file exists in the parent directory\n2. Check that `ANTHROPIC_API_KEY=sk-ant-api03-...` is set\n3. Restart the Jupyter kernel after creating/editing `.env`\n\n### Issue 2: Container Parameter Not Recognized\n\n**Error:**\n```\nTypeError: Messages.create() got an unexpected keyword argument 'container'\n```\n\n**Solution:**\nUse `client.beta.messages.create()` instead of `client.messages.create()`:\n```python\n# \u2705 Correct - use beta.messages\nresponse = client.beta.messages.create(\n    model=MODEL,\n    container={\"skills\": [...]},\n    tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n    messages=[...],\n    betas=[\"code-execution-2025-08-25\", \"files-api-2025-04-14\", \"skills-2025-10-02\"]\n)\n\n# \u274c Incorrect - regular messages doesn't support container\nresponse = client.messages.create(\n    model=MODEL,\n    container={\"skills\": [...]},  # Error!\n    messages=[...]\n)\n```\n\n### Issue 3: Skills Beta Requires Code Execution Tool\n\n**Error:**\n```\nBadRequestError: Skills beta requires the code_execution tool to be included in the request.\n```\n\n**Solution:**\nWhen using Skills, you MUST include the code_execution tool:\n```python\n# \u2705 Correct\nresponse = client.beta.messages.create(\n    model=MODEL,\n    tools=[{\"type\": \"code_execution_20250825\", \"name\": \"code_execution\"}],\n    messages=[...],\n    betas=[\"...\", \"skills-2025-10-02\"]\n)\n\n# \u274c Incorrect - missing code_execution tool\nresponse = client.beta.messages.create(\n    model=MODEL,\n    messages=[...],\n    betas=[\"...\", \"skills-2025-10-02\"]\n)\n```\n\n### Issue 4: No Files Found in Response\n\n**Error:**\n```\n\u274c No files found in response\n```\n\n**Solution:**\n1. Check that code execution tool is included in the request\n2. Verify the skill was loaded (check response content)\n3. Ensure the task actually requires file creation\n4. Look for error messages in the response text\n\n### Issue 5: File Download Failed\n\n**Error:**\n```\nError retrieving file: File not found\n```\n\n**Solution:**\n1. Files may have a limited lifetime on Anthropic's servers\n2. Download files immediately after creation\n3. Check file_id is correctly extracted from response\n4. Verify Files API beta is included in betas list\n\n---\n\n# Cell 38 (markdown)\n### Token Optimization Tips\n\n1. **Use \"latest\" version** for Anthropic skills - automatically optimized\n2. **Batch operations** - Create multiple files in one conversation when possible\n3. **Reuse containers** - Use `container.id` from previous responses to avoid reloading skills\n4. **Be specific** - Clear instructions mean fewer iterations\n\n---\n\n# Cell 39 (markdown)\n### API Rate Limiting\n\nIf you encounter rate limits:\n- Implement exponential backoff for retries\n- Use batch processing for multiple files\n- Consider upgrading your API tier for higher limits\n\n---\n\n# Cell 40 (markdown)\n## Next Steps\n\n\ud83c\udf89 **Congratulations!** You've learned the basics of Claude Skills.\n\n### See Skills in Action\n\nCheck out the official announcement to see how these Skills power Claude's file creation capabilities:\n- **[Claude Creates Files](https://www.anthropic.com/news/create-files)** - See how Skills enable Claude to create and edit Excel, PowerPoint, and PDF files directly\n\n### Continue Learning:\n\n- **[Notebook 2: Financial Applications](02_skills_financial_applications.ipynb)** - Real-world business use cases with financial data\n- **[Notebook 3: Custom Skills Development](03_skills_custom_development.ipynb)** - Build your own specialized skills\n\n### Support Articles:\n\n- \ud83d\udcda **[Teach Claude your way of working using Skills](https://support.claude.com/en/articles/12580051-teach-claude-your-way-of-working-using-skills)** - User guide for working with Skills\n- \ud83d\udee0\ufe0f **[How to create a skill with Claude through conversation](https://support.claude.com/en/articles/12599426-how-to-create-a-skill-with-claude-through-conversation)** - Interactive skill creation guide\n\n### Resources:\n\n- [Claude API Documentation](https://docs.anthropic.com/en/api/messages)\n- [Skills Documentation](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/overview)\n- [Skills Best Practices](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/best-practices)\n- [Files API Documentation](https://docs.claude.com/en/api/files-content)\n- [Claude Support](https://support.claude.com)\n\n### Try These Experiments:\n\n1. Start with simple one-line prompts to see Skills in action\n2. Modify the budget example to include more categories\n3. Create a presentation with your own data\n4. Generate a PDF report combining text and tables\n5. Use multiple skills together in a single request\n\n---\n\n"
  ]
}