{
  "session_id": "70dafd63-59ca-4c55-b033-9a165328ef66",
  "prompts": [
    "# IDENTITY and PURPOSE\n\nYou are an expert AI agent architect and automation specialist. You analyze content to identify workflow patterns, automation opportunities, and potential Claude Code agents or hooks that could be generated to streamline repetitive tasks or complex workflows.\n\nTake a step back and think step-by-step about how to identify automatable patterns and translate content insights into actionable agent and hook configurations.\n\n# STEPS\n\n- Analyze the content for workflow patterns, repetitive tasks, and manual processes\n- Identify trigger events that could initiate automated workflows\n- Map content workflows to potential Claude Code agents\n- Determine hook opportunities based on event-driven patterns\n- Assess tool requirements and feasibility\n- Prioritize opportunities by impact and implementation complexity\n\n# OUTPUT INSTRUCTIONS\n\n- Only output Markdown\n- All sections are required (use \"None identified\" if a section has no content)\n- Be specific and actionable in recommendations\n- Include actual configuration suggestions in YAML frontmatter format\n- Focus on practical, implementable solutions\n- Do not give warnings or notes; only output the requested sections\n\n# OUTPUT SECTIONS\n\n## WORKFLOW_PATTERNS\n\n### Pattern [N]: [Workflow name]\n**Description**: [What this workflow accomplishes]\n**Trigger**: [What initiates this workflow]\n**Steps**:\n1. [Step in workflow]\n2. [Step in workflow]\n3. [Step in workflow]\n\n**Automation Potential**: [High | Medium | Low]\n**Complexity**: [Simple | Moderate | Complex]\n**Frequency**: [How often this workflow occurs]\n\n[Repeat for each identified pattern]\n\n## AGENT_CANDIDATES\n\n### Agent [N]: [Proposed agent name]\n\n**Purpose**: [What this agent would do]\n\n**Frontmatter Configuration**:\n```yaml\n---\nname: [agent-name-slug]\ndescription: [1-2 sentence description of when to use this agent]\ntools: [List of required tools: Bash, Read, Write, Grep, etc.]\ncolor: [blue | green | purple | orange | red]\n---\n```\n\n**Core Capabilities**:\n- [Capability 1]\n- [Capability 2]\n- [Capability 3]\n\n**Workflow**:\n1. [Agent workflow step]\n2. [Agent workflow step]\n3. [Agent workflow step]\n\n**Inputs Required**:\n- [Input parameter]: [Description]\n\n**Expected Outputs**:\n- [Output]: [Format/location]\n\n**Priority**: [High | Medium | Low]\n**Implementation Complexity**: [Simple | Moderate | Complex]\n**Impact**: [High | Medium | Low]\n\n[Repeat for each agent candidate]\n\n## HOOK_OPPORTUNITIES\n\n### Hook [N]: [Hook type]\n\n**Hook Type**: [session_start | stop | user_prompt_submit | pre_tool_use | post_tool_use | subagent_stop | notification | pre_compact]\n\n**Trigger Event**: [What event triggers this hook]\n\n**Purpose**: [What this hook accomplishes]\n\n**Implementation**:\n```python\n# Pseudocode for hook logic\ndef hook_function(context):\n    # [Step 1]\n    # [Step 2]\n    # [Step 3]\n    return result\n```\n\n**Integration Points**:\n- [Where this hooks into existing system]\n\n**Data Flow**:\n- Input: [What data the hook receives]\n- Processing: [What it does with the data]\n- Output: [What it returns or triggers]\n\n**Priority**: [High | Medium | Low]\n**Implementation Complexity**: [Simple | Moderate | Complex]\n\n[Repeat for each hook opportunity]\n\n## CUSTOM_PATTERNS\n\n### Pattern [N]: [Pattern name]\n\n**Purpose**: [What this fabric pattern would extract/analyze]\n\n**Input Type**: [Text | Video transcript | Code | Documentation]\n\n**Output Sections**:\n- [Section name]: [What it contains]\n- [Section name]: [What it contains]\n\n**Use Case**: [When you'd use this pattern]\n\n**Similar Existing Patterns**: [List any similar patterns that exist]\n\n**Priority**: [High | Medium | Low]\n\n[Repeat for each custom pattern opportunity]\n\n## TOOL_REQUIREMENTS\n\n### For Agents\n- [Tool name]: [Why it's needed] - [Already available? Yes/No]\n\n### For Hooks\n- [Tool/library name]: [Why it's needed] - [Already available? Yes/No]\n\n### For Patterns\n- [Resource/API]: [Why it's needed] - [Already available? Yes/No]\n\n### External Dependencies\n- [Dependency]: [Purpose] - [Installation required? Yes/No]\n\n## INTEGRATION_ARCHITECTURE\n\n### System Components\n```\n[Diagram showing how agents, hooks, and patterns interact]\n\nExample:\nUser Input \u2192 Hook Detection \u2192 Agent Trigger \u2192 Pattern Analysis \u2192 Output Generation \u2192 Hook Notification\n```\n\n### Data Flow\n1. [Entry point]\n2. [Processing step]\n3. [Output/storage]\n\n### Event Chain\n- [Event 1] \u2192 [Triggers] \u2192 [Event 2] \u2192 [Results in] \u2192 [Event 3]\n\n## IMPLEMENTATION_PRIORITY\n\n### High Priority (Implement First)\n1. **[Agent/Hook/Pattern name]**\n   - **Why**: [Impact and reasoning]\n   - **Effort**: [Time/complexity estimate]\n   - **Dependencies**: [What's needed]\n\n### Medium Priority (Implement Second)\n2. **[Agent/Hook/Pattern name]**\n   - **Why**: [Impact and reasoning]\n   - **Effort**: [Time/complexity estimate]\n   - **Dependencies**: [What's needed]\n\n### Low Priority (Nice to Have)\n3. **[Agent/Hook/Pattern name]**\n   - **Why**: [Impact and reasoning]\n   - **Effort**: [Time/complexity estimate]\n   - **Dependencies**: [What's needed]\n\n## EXAMPLE_CONFIGURATIONS\n\n### Sample Agent File\n```markdown\n---\nname: example-agent\ndescription: Brief description of what this agent does\ntools: Bash, Read, Write\ncolor: blue\n---\n\nYou are an agent that [purpose].\n\nWhen invoked, you should:\n1. [Step]\n2. [Step]\n3. [Step]\n\nOutput format: [Describe output]\n```\n\n### Sample Hook Script\n```python\n#!/usr/bin/env python3\n\"\"\"\nHook: [hook_name]\nTrigger: [When it runs]\nPurpose: [What it does]\n\"\"\"\n\ndef main(context_data):\n    # Implementation\n    pass\n\nif __name__ == \"__main__\":\n    main()\n```\n\n### Sample Pattern Invocation\n```bash\nfabric -y \"INPUT\" --pattern pattern_name\n```\n\n## SCALABILITY_CONSIDERATIONS\n\n### Multi-Agent Workflows\n- [How multiple agents could work together]\n\n### Hook Chaining\n- [How hooks could trigger each other]\n\n### Pattern Pipelines\n- [How patterns could be chained for comprehensive analysis]\n\n### Data Persistence\n- [Where and how to store intermediate results]\n\n## SUCCESS_METRICS\n\n### For Agents\n- [Metric]: [How to measure success]\n\n### For Hooks\n- [Metric]: [How to measure success]\n\n### For Patterns\n- [Metric]: [How to measure success]\n\n## NEXT_STEPS\n\n1. [Immediate action to take]\n2. [Next action]\n3. [Follow-up action]\n\n## RECOMMENDATIONS\n\n### Quick Wins\n- [Easy to implement, high impact opportunity]\n\n### Strategic Investments\n- [Higher effort, transformative opportunities]\n\n### Future Enhancements\n- [Ideas for future iteration]\n\n# INPUT\n\nINPUT:\n\n\n# INPUT\n\n# Cell 1 (markdown)\n# Parallel tool calls on Claude 3.7 Sonnet\n\n---\n\n# Cell 2 (markdown)\nClaude 3.7 Sonnet may be less likely to make make parallel tool calls in a response, even when you have not set `disable_parallel_tool_use`. To work around this, we recommend introducing a \"batch tool\" that can act as a meta-tool to wrap invocations to other tools simultaneously. We find that if this tool is present, the model will use it to simultaneously call multiple tools in parallel for you.\n\nLet's take a look at the problem, and examine this workaround in more detail.\n\n---\n\n# Cell 3 (code)\n```python\nfrom anthropic import Anthropic\n\nclient = Anthropic()\nMODEL_NAME = \"claude-sonnet-4-5\"\n```\n\n---\n\n# Cell 4 (markdown)\n## Performing a query with multiple tool calls\n\nRecall that the default behavior is for Claude to be allowed parallel tool calls. Combined with the default `tool_choice` of `auto`, this means that Claude can call any of the specified tools, or call more than one of them in a single assistant turn.\n\nLet's set Claude up with a `get_weather` and `get_time` tool.\n\n---\n\n# Cell 5 (code)\n```python\ndef get_weather(location):\n    # Pretend to get the weather, and just return a fixed value.\n    return f\"The weather in {location} is 72 degrees and sunny.\"\n\n\ndef get_time(location):\n    # Pretend to get the time, and just return a fixed value.\n    return f\"The time in {location} is 12:32 PM.\"\n\n\nweather_tool = {\n    \"name\": \"get_weather\",\n    \"description\": \"Gets the weather for in a given location\",\n    \"input_schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n            \"location\": {\n                \"type\": \"string\",\n                \"description\": \"The city and state, e.g. San Francisco, CA\",\n            },\n        },\n        \"required\": [\"location\"],\n    },\n}\n\ntime_tool = {\n    \"name\": \"get_time\",\n    \"description\": \"Gets the time in a given location\",\n    \"input_schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n            \"location\": {\n                \"type\": \"string\",\n                \"description\": \"The city and state, e.g. San Francisco, CA\",\n            },\n        },\n        \"required\": [\"location\"],\n    },\n}\n\n\ndef process_tool_call(tool_name, tool_input):\n    if tool_name == \"get_weather\":\n        return get_weather(tool_input[\"location\"])\n    elif tool_name == \"get_time\":\n        return get_time(tool_input[\"location\"])\n    else:\n        raise ValueError(f\"Unexpected tool name: {tool_name}\")\n```\n\n---\n\n# Cell 6 (markdown)\nNext, let's provide Claude with these tools and perform a query.\n\n---\n\n# Cell 7 (code)\n```python\ndef make_query_and_print_result(messages, tools=None):\n    response = client.messages.create(\n        model=MODEL_NAME,\n        messages=messages,\n        max_tokens=1000,\n        tool_choice={\"type\": \"auto\"},\n        tools=tools or [weather_tool, time_tool],\n    )\n\n    for block in response.content:\n        match block.type:\n            case \"text\":\n                print(block.text)\n            case \"tool_use\":\n                print(f\"Tool: {block.name}({block.input})\")\n            case _:\n                raise ValueError(f\"Unexpected block type: {block.type}\")\n\n    return response\n\n\nMESSAGES = [{\"role\": \"user\", \"content\": \"What's the weather and time in San Francisco?\"}]\n\nresponse = make_query_and_print_result(MESSAGES)\n```\n\n**Output:**\n```\nI'll check the current weather and time in San Francisco for you.\nTool: get_weather({'location': 'San Francisco, CA'})\n\n```\n\n---\n\n# Cell 8 (markdown)\nNotice how claude returned with a single tool call for the weather, even though we asked for both?\n\nLet's see what happens if we call the weather tool and proceed.\n\n---\n\n# Cell 9 (code)\n```python\nlast_tool_call = response.content[1]\n\nMESSAGES.append({\"role\": \"assistant\", \"content\": response.content})\nMESSAGES.append(\n    {\n        \"role\": \"user\",\n        \"content\": [\n            {\n                \"type\": \"tool_result\",\n                \"tool_use_id\": last_tool_call.id,\n                \"content\": process_tool_call(response.content[1].name, response.content[1].input),\n            }\n        ],\n    }\n)\n\nresponse = make_query_and_print_result(MESSAGES)\n```\n\n**Output:**\n```\nTool: get_time({'location': 'San Francisco, CA'})\n\n```\n\n---\n\n# Cell 10 (markdown)\nNotice now that Claude made a second tool call to get the time. While this technically happened immediately, this is potentially wasteful because it required \"back and forth\" \u2013 first Claude asked for the weather, then we had to process it, and _then_ Claude asked for the time, and now we have to process _that_.\n\nClaude will still do the right thing with the results, but it may be beneficial to encourage Claude to use both in one call, so we can process it simultaneously.\n\n---\n\n# Cell 11 (markdown)\n## Introducing a batch tool\n\nLet's introduce a `batch_tool`, so that Claude can have an opportunity to use it to combine multiple tool calls into one.\n\n---\n\n# Cell 12 (code)\n```python\nimport json\n\nbatch_tool = {\n    \"name\": \"batch_tool\",\n    \"description\": \"Invoke multiple other tool calls simultaneously\",\n    \"input_schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n            \"invocations\": {\n                \"type\": \"array\",\n                \"description\": \"The tool calls to invoke\",\n                \"items\": {\n                    \"types\": \"object\",\n                    \"properties\": {\n                        \"name\": {\n                            \"types\": \"string\",\n                            \"description\": \"The name of the tool to invoke\",\n                        },\n                        \"arguments\": {\n                            \"types\": \"string\",\n                            \"description\": \"The arguments to the tool\",\n                        },\n                    },\n                    \"required\": [\"name\", \"arguments\"],\n                },\n            }\n        },\n        \"required\": [\"invocations\"],\n    },\n}\n\n\ndef process_tool_with_maybe_batch(tool_name, tool_input):\n    if tool_name == \"batch_tool\":\n        results = []\n        for invocation in tool_input[\"invocations\"]:\n            results.append(\n                process_tool_call(invocation[\"name\"], json.loads(invocation[\"arguments\"]))\n            )\n        return \"\\n\".join(results)\n    else:\n        return process_tool_call(tool_name, tool_input)\n```\n\n---\n\n# Cell 13 (markdown)\nNow let's try to provide Claude with the existing weather and time tool, along with this new batch tool, and see what happens when we make a query requiring the weather and time.\n\n---\n\n# Cell 14 (code)\n```python\nMESSAGES = [{\"role\": \"user\", \"content\": \"What's the weather and time in San Francisco?\"}]\n\nresponse = make_query_and_print_result(MESSAGES, tools=[weather_tool, time_tool, batch_tool])\n```\n\n**Output:**\n```\nI can help you check both the weather and the time in San Francisco. Let me get that information for you right away.\nTool: batch_tool({'invocations': [{'name': 'get_weather', 'arguments': '{\"location\": \"San Francisco, CA\"}'}, {'name': 'get_time', 'arguments': '{\"location\": \"San Francisco, CA\"}'}]})\n\n```\n\n---\n\n# Cell 15 (markdown)\nNotice how this time, Claude used the batch tool to query both the time and weather in one go. This allows us to process them simultaneously, potentially improving overall latency to the result.\n\n---\n\n# Cell 16 (code)\n```python\nlast_tool_call = response.content[1]\n\nMESSAGES.append({\"role\": \"assistant\", \"content\": response.content})\nMESSAGES.append(\n    {\n        \"role\": \"user\",\n        \"content\": [\n            {\n                \"type\": \"tool_result\",\n                \"tool_use_id\": last_tool_call.id,\n                \"content\": process_tool_with_maybe_batch(\n                    response.content[1].name, response.content[1].input\n                ),\n            }\n        ],\n    }\n)\n\nresponse = make_query_and_print_result(MESSAGES)\n```\n\n**Output:**\n```\nHere's the information you requested:\n\nWeather in San Francisco, CA: 72 degrees and sunny\nTime in San Francisco, CA: 12:32 PM\n\nIs there anything else you'd like to know about San Francisco?\n\n```\n\n---\n\n"
  ]
}