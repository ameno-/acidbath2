---
interface Props {
  type: 'note' | 'tip' | 'info' | 'warning' | 'danger' | 'quote';
  title?: string;
  author?: string;
}

const { type, title, author } = Astro.props;

const variants = {
  note: {
    icon: 'â„¹',
    borderColor: '#1e3a8a', // blue-900
    bgColor: 'rgba(23, 37, 84, 0.5)', // blue-950/50
    textColor: '#60a5fa', // blue-400
    defaultTitle: 'Note'
  },
  tip: {
    icon: 'ðŸ’¡',
    borderColor: '#581c87', // purple-900
    bgColor: 'rgba(59, 7, 100, 0.5)', // purple-950/50
    textColor: '#c084fc', // purple-400
    defaultTitle: 'Tip'
  },
  info: {
    icon: 'â„¹',
    borderColor: '#1e3a8a', // blue-900
    bgColor: 'rgba(23, 37, 84, 0.5)', // blue-950/50
    textColor: '#60a5fa', // blue-400
    defaultTitle: 'Info'
  },
  warning: {
    icon: 'âš ',
    borderColor: '#78350f', // amber-900
    bgColor: 'rgba(69, 26, 3, 0.5)', // amber-950/50
    textColor: '#fbbf24', // amber-400
    defaultTitle: 'Warning'
  },
  danger: {
    icon: 'â›”',
    borderColor: '#7f1d1d', // red-900
    bgColor: 'rgba(69, 10, 10, 0.5)', // red-950/50
    textColor: '#f87171', // red-400
    defaultTitle: 'Danger'
  },
  quote: {
    icon: '"',
    borderColor: '#cbd5e1', // slate-300
    bgColor: 'rgba(15, 23, 42, 0.5)', // slate-900/50
    textColor: '#cbd5e1', // slate-300
    defaultTitle: 'Quote'
  }
};

const variant = variants[type];
const displayTitle = title || variant.defaultTitle;
---

<div class={`callout callout-${type}`}>
  {type === 'quote' && (
    <div class="quote-mark">{variant.icon}</div>
  )}
  <div class="callout-header">
    {type !== 'quote' && (
      <span class="callout-icon">{variant.icon}</span>
    )}
    <span class="callout-title">{displayTitle}</span>
  </div>
  <div class="callout-content">
    <slot />
  </div>
  {author && type === 'quote' && (
    <div class="callout-author">â€” {author}</div>
  )}
</div>

<style define:vars={{
  borderColor: variant.borderColor,
  bgColor: variant.bgColor,
  textColor: variant.textColor
}}>
  .callout {
    position: relative;
    margin: var(--space-6) 0;
    padding: var(--space-4);
    border-left: 2px solid var(--borderColor);
    background: var(--bgColor);
    border-radius: var(--radius-sm);
  }

  .callout-quote {
    border-left-width: 4px;
    background: transparent;
    padding-left: var(--space-8);
  }

  .quote-mark {
    position: absolute;
    left: var(--space-2);
    top: var(--space-2);
    font-size: var(--text-4xl);
    color: var(--borderColor);
    line-height: 1;
    font-weight: 800;
    opacity: 0.3;
  }

  .callout-header {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-3);
    font-weight: 700;
    text-transform: uppercase;
    font-size: var(--text-sm);
    color: var(--textColor);
  }

  .callout-quote .callout-header {
    display: none;
  }

  .callout-icon {
    font-size: var(--text-lg);
    line-height: 1;
  }

  .callout-title {
    letter-spacing: 0.05em;
  }

  .callout-content {
    color: var(--color-foreground);
    line-height: 1.6;
  }

  .callout-quote .callout-content {
    font-style: italic;
    font-size: var(--text-lg);
    color: var(--color-foreground-alt);
  }

  .callout-content :global(p:first-child) {
    margin-top: 0;
  }

  .callout-content :global(p:last-child) {
    margin-bottom: 0;
  }

  .callout-content :global(code) {
    background: var(--color-background-code);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    font-size: 0.9em;
  }

  .callout-author {
    margin-top: var(--space-4);
    font-weight: 600;
    font-style: normal;
    color: var(--textColor);
    text-align: right;
  }

  /* Nested element spacing */
  .callout-content :global(> * + *) {
    margin-top: var(--space-4);
  }
</style>
