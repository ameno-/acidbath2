{
  "session_id": "c4052fd7-f091-490f-bb75-4ad0ee66664b",
  "prompts": [
    "/commit sdlc_implementor feature {\"number\": \"jerry-simple-update\", \"title\": \"Local Issue jerry-simple-update\", \"body\": \"# Issue: Jerry Simple Update System (Option B)\\n\\n## Summary\\n\\nImplement a simple version-based update system for Jerry installations using git-diff style updates. This replaces the over-engineered migration framework proposal with a minimal, maintainable solution.\\n\\n## Problem\\n\\n1. Jerry installations currently have no update mechanism\\n2. Two external applications have Jerry bootstrapped but are unversioned\\n3. Users must manually re-bootstrap to get updates, risking loss of customizations\\n4. The previously proposed update system was over-engineered (2000+ lines, migration framework, rollback logic)\\n\\n## Solution: Option B - Version File + Diff-Based Update\\n\\nA simple update script (~100-150 lines) that:\\n1. Reads local version from manifest (treats missing version as \\\"0.0.0\\\")\\n2. Fetches remote version from GitHub releases or export tarball\\n3. Downloads and extracts update package\\n4. Rsyncs core files while preserving user directories\\n5. Updates manifest version\\n\\n## Requirements\\n\\n### Functional Requirements\\n\\n1. **Version Detection**\\n   - Read version from `.jerry/manifest.json`\\n   - Handle missing version field (treat as \\\"0.0.0\\\" baseline)\\n   - Validate semver format\\n\\n2. **Update Source Support**\\n   - Support GitHub releases as update source\\n   - Support local tarball as update source\\n   - Support direct path to another Jerry installation\\n\\n3. **File Management**\\n   - Core directories to update: `adws/`, `.claude/`, `.jerry/`\\n   - Preserved directories: `agents/`, `trees/`, `specs/`, `.env`, `.ports.env`\\n   - Handle new files in core directories\\n   - Don't delete user customizations\\n\\n4. **Update Modes**\\n   - Pull mode: Run from installation, pull updates from source\\n   - Dry-run mode: Show what would change without applying\\n\\n5. **User Experience**\\n   - Clear version comparison output\\n   - Progress indication during update\\n   - Post-update summary\\n   - Point users to CHANGELOG.md for breaking changes\\n\\n### Non-Functional Requirements\\n\\n1. **Simplicity**: Single file implementation (~100-150 lines)\\n2. **Testability**: Unit tests for all functions\\n3. **No dependencies beyond existing**: click, rich (already in Jerry)\\n\\n## Files to Create/Modify\\n\\n### New Files\\n- `adws/jerry_update.py` - Main update script\\n- `adws/tests/test_jerry_update.py` - Unit tests\\n\\n### Modified Files\\n- `.jerry/manifest.json` - Add `update_url` field\\n- `CHANGELOG.md` - Create if not exists\\n\\n## Technical Design\\n\\n### Core Functions\\n\\n```python\\ndef get_local_version(jerry_root: Path) -> str:\\n    \\\"\\\"\\\"Read version from manifest, return '0.0.0' if missing.\\\"\\\"\\\"\\n\\ndef get_remote_version(source: str) -> tuple[str, Path]:\\n    \\\"\\\"\\\"Get version from remote source (GitHub/tarball/path).\\\"\\\"\\\"\\n\\ndef compare_versions(local: str, remote: str) -> int:\\n    \\\"\\\"\\\"Compare semver versions: -1 (older), 0 (same), 1 (newer).\\\"\\\"\\\"\\n\\ndef sync_core_files(source: Path, target: Path, dry_run: bool) -> list[str]:\\n    \\\"\\\"\\\"Rsync core directories, return list of changed files.\\\"\\\"\\\"\\n\\ndef update_manifest_version(jerry_root: Path, version: str) -> None:\\n    \\\"\\\"\\\"Update version in manifest.json.\\\"\\\"\\\"\\n```\\n\\n### CLI Interface\\n\\n```bash\\n# Update from GitHub releases (default)\\n./adws/jerry_update.py\\n\\n# Update from local tarball\\n./adws/jerry_update.py --source /path/to/jerry-export.tar.gz\\n\\n# Update from another Jerry installation\\n./adws/jerry_update.py --source /path/to/jerry-source\\n\\n# Dry run\\n./adws/jerry_update.py --dry-run\\n\\n# Force update even if same/older version\\n./adws/jerry_update.py --force\\n```\\n\\n## Migration Path for Unversioned Installations\\n\\n### Scenario: Installation has no version field\\n\\n1. `jerry_update.py` detects missing version, treats as \\\"0.0.0\\\"\\n2. Any version > \\\"0.0.0\\\" triggers update\\n3. Update adds version field to manifest\\n4. User is now on versioned Jerry\\n\\n### First-Time Update Command for External Installations\\n\\n```bash\\n# From the external installation directory:\\ncurl -sL https://github.com/ameno-/tac/releases/latest/download/jerry-update.py | python3 -\\n# OR\\n./adws/jerry_update.py --source https://github.com/ameno-/tac\\n```\\n\\n## Unit Test Cases\\n\\n1. **test_get_local_version_exists** - Version field present\\n2. **test_get_local_version_missing** - No version field returns \\\"0.0.0\\\"\\n3. **test_get_local_version_invalid_json** - Handle malformed manifest\\n4. **test_compare_versions** - All comparison cases\\n5. **test_sync_core_files_dry_run** - No changes in dry run\\n6. **test_sync_core_files_preserves_user_dirs** - agents/, trees/, specs/ untouched\\n7. **test_update_manifest_version** - Version updated correctly\\n8. **test_full_update_flow** - Integration test\\n\\n## Acceptance Criteria\\n\\n- [ ] `jerry_update.py` implemented with all core functions\\n- [ ] Unit tests pass for all functions\\n- [ ] Dry-run mode works correctly\\n- [ ] Update preserves user directories\\n- [ ] Unversioned installations can update (0.0.0 baseline)\\n- [ ] Clear CLI output with version comparison\\n- [ ] CHANGELOG.md created with initial entry\\n\\n## Out of Scope\\n\\n- Migration scripts for breaking changes (humans read CHANGELOG)\\n- Rollback functionality\\n- Version compatibility matrix\\n- Auto-update checks\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:43:00.674487) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_ops: \\u2705 Starting isolated planning phase\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:43:00.675286) by 2fa04caa\\n\\n2fa04caa_ops: \\ud83d\\udd0d Using state\\n```json\\n{\\n  \\\"adw_id\\\": \\\"2fa04caa\\\",\\n  \\\"issue_number\\\": \\\"jerry-simple-update\\\",\\n  \\\"issue_source\\\": \\\"local\\\",\\n  \\\"issue_ref\\\": \\\"local:jerry-simple-update\\\",\\n  \\\"branch_name\\\": null,\\n  \\\"plan_file\\\": null,\\n  \\\"issue_class\\\": null,\\n  \\\"worktree_path\\\": null,\\n  \\\"backend_port\\\": 9113,\\n  \\\"frontend_port\\\": 9213,\\n  \\\"model_set\\\": \\\"base\\\",\\n  \\\"all_adws\\\": [\\n    \\\"adw_plan_iso\\\"\\n  ],\\n  \\\"execution_plan\\\": null,\\n  \\\"model_strategy\\\": \\\"auto\\\",\\n  \\\"phases_completed\\\": [],\\n  \\\"metadata\\\": {}\\n}\\n```\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:43:05.730364) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_ops: \\u2705 Issue classified as: /feature\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:46:00.840120) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_ops: \\u2705 Working in isolated worktree: /Users/ameno/dev/tac/tac-8/trees/2fa04caa\\n\\ud83d\\udd0c Ports - Backend: 9113, Frontend: 9213\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:46:00.840471) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_sdlc_planner: \\u2705 Building implementation plan in isolated environment\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:48:32.193067) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_sdlc_planner: \\u2705 Implementation plan created\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:48:32.193828) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_ops: \\u2705 Plan file created: specs/feature-2fa04caa-jerry-simple-update.md\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:48:49.872759) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_sdlc_planner: \\u2705 Plan committed\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:48:49.873081) by 2fa04caa\\n\\n[ADW_BOT] 2fa04caa_ops: \\u2705 Isolated planning phase completed\\n\\n\\n---\\n\\n**Comment** (2025-12-16T19:48:49.873576) by 2fa04caa\\n\\n2fa04caa_ops: \\ud83d\\udccb Final planning state:\\n```json\\n{\\n  \\\"adw_id\\\": \\\"2fa04caa\\\",\\n  \\\"issue_number\\\": \\\"jerry-simple-update\\\",\\n  \\\"issue_source\\\": \\\"local\\\",\\n  \\\"issue_ref\\\": \\\"local:jerry-simple-update\\\",\\n  \\\"branch_name\\\": \\\"feat-issue-jerry-simple-update-adw-2fa04caa-simple-version-update\\\",\\n  \\\"plan_file\\\": \\\"specs/feature-2fa04caa-jerry-simple-update.md\\\",\\n  \\\"issue_class\\\": \\\"/feature\\\",\\n  \\\"worktree_path\\\": \\\"/Users/ameno/dev/tac/tac-8/trees/2fa04caa\\\",\\n  \\\"backend_port\\\": 9113,\\n  \\\"frontend_port\\\": 9213,\\n  \\\"model_set\\\": \\\"base\\\",\\n  \\\"all_adws\\\": [\\n    \\\"adw_plan_iso\\\"\\n  ],\\n  \\\"execution_plan\\\": null,\\n  \\\"model_strategy\\\": \\\"auto\\\",\\n  \\\"phases_completed\\\": [],\\n  \\\"metadata\\\": {}\\n}\\n```\\n\"}"
  ]
}